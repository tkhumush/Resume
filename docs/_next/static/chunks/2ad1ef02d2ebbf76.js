(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8948,e=>{"use strict";let t,r,n,i,o,s;var a,l,u,c,h,f,d,p=e.i(1398),g=e.i(1788);function y(e){if(!Number.isSafeInteger(e)||e<0)throw Error(`Wrong positive integer: ${e}`)}function b(e,...t){if(!(e instanceof Uint8Array))throw Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function m(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}let w="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,E=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),x=(e,t)=>e<<32-t|e>>>t;if(68!==new Uint8Array(new Uint32Array([0x11223344]).buffer)[0])throw Error("Non little-endian hardware is not supported");function v(e){if("string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}(e)),!(e instanceof Uint8Array))throw Error(`expected Uint8Array, got ${typeof e}`);return e}class A{clone(){return this._cloneInto()}}function S(e=32){if(w&&"function"==typeof w.getRandomValues)return w.getRandomValues(new Uint8Array(e));throw Error("crypto.getRandomValues must be defined")}class U extends A{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=E(this.buffer)}update(e){m(this);let{view:t,buffer:r,blockLen:n}=this,i=(e=v(e)).length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){let t=E(e);for(;n<=i-o;o+=n)this.process(t,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){m(this);b(e);let t=this.outputLen;if(e.length<t)throw Error(`digestInto() expects output buffer of length at least ${t}`);this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let e=s;e<i;e++)r[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);let i=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>i&o),a=Number(r&o),l=4*!!n,u=4*!n;e.setUint32(t+l,s,n),e.setUint32(t+u,a,n)}(n,i-8,BigInt(8*this.length),o),this.process(n,0);let a=E(e),l=this.outputLen;if(l%4)throw Error("_sha2: outputLen should be aligned to 32bit");let u=l/4,c=this.get();if(u>c.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<u;e++)a.setUint32(4*e,c[e],o)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return e.length=n,e.pos=s,e.finished=i,e.destroyed=o,n%t&&e.buffer.set(r),e}}let B=(e,t,r)=>e&t^~e&r,I=(e,t,r)=>e&t^e&r^t&r,k=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),N=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),T=new Uint32Array(64);class L extends U{constructor(){super(64,32,8,!1),this.A=0|N[0],this.B=0|N[1],this.C=0|N[2],this.D=0|N[3],this.E=0|N[4],this.F=0|N[5],this.G=0|N[6],this.H=0|N[7]}get(){let{A:e,B:t,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[e,t,r,n,i,o,s,a]}set(e,t,r,n,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)T[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=T[e-15],r=T[e-2],n=x(t,7)^x(t,18)^t>>>3,i=x(r,17)^x(r,19)^r>>>10;T[e]=i+T[e-7]+n+T[e-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:l,H:u}=this;for(let e=0;e<64;e++){let t=u+(x(s,6)^x(s,11)^x(s,25))+B(s,a,l)+k[e]+T[e]|0,c=(x(r,2)^x(r,13)^x(r,22))+I(r,n,i)|0;u=l,l=a,a=s,s=o+t|0,o=i,i=n,n=r,r=t+c|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,l,u)}roundClean(){T.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let _=(a=()=>new L,(t=e=>a().update(v(e)).digest()).outputLen=(r=a()).outputLen,t.blockLen=r.blockLen,t.create=()=>a(),t),O=BigInt(0),R=BigInt(1),$=BigInt(2),P=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function H(e){if(!(e instanceof Uint8Array))throw Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=P[e[r]];return t}function C(e){let t=e.toString(16);return 1&t.length?`0${t}`:t}function q(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}function M(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(t/2);for(let t=0;t<r.length;t++){let n=2*t,i=Number.parseInt(e.slice(n,n+2),16);if(Number.isNaN(i)||i<0)throw Error("Invalid byte sequence");r[t]=i}return r}function j(e){return q(H(e))}function V(e){if(!(e instanceof Uint8Array))throw Error("Uint8Array expected");return q(H(Uint8Array.from(e).reverse()))}function z(e,t){return M(e.toString(16).padStart(2*t,"0"))}function D(e,t){return z(e,t).reverse()}function F(e){return M(C(e))}function W(e,t,r){let n;if("string"==typeof t)try{n=M(t)}catch(r){throw Error(`${e} must be valid hex string, got "${t}". Cause: ${r}`)}else if(t instanceof Uint8Array)n=Uint8Array.from(t);else throw Error(`${e} must be hex string or Uint8Array`);let i=n.length;if("number"==typeof r&&i!==r)throw Error(`${e} expected ${r} bytes, got ${i}`);return n}function Z(...e){let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),r=0;return e.forEach(e=>{if(!(e instanceof Uint8Array))throw Error("Uint8Array expected");t.set(e,r),r+=e.length}),t}function K(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function G(e){if("string"!=typeof e)throw Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function J(e){let t;for(t=0;e>O;e>>=R,t+=1);return t}function X(e,t){return e>>BigInt(t)&R}let Y=e=>($<<BigInt(e-1))-R,Q=e=>new Uint8Array(e);function ee(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=Q(e),i=Q(e),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...e)=>r(i,n,...e),l=(e=Q())=>{let t;if(i=a((t=[0],Uint8Array.from(t)),e),n=a(),0!==e.length){let t;i=a((t=[1],Uint8Array.from(t)),e),n=a()}},u=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(n=a()).slice();r.push(t),e+=n.length}return Z(...r)};return(e,t)=>{let r;for(s(),l(e);!(r=t(u()));)l();return s(),r}}let et={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function er(e,t,r={}){let n=(t,r,n)=>{let i=et[r];if("function"!=typeof i)throw Error(`Invalid validator "${r}", expected function`);let o=e[t];if((!n||void 0!==o)&&!i(o,e))throw Error(`Invalid param ${String(t)}=${o} (${typeof o}), expected ${r}`)};for(let[e,r]of Object.entries(t))n(e,r,!1);for(let[e,t]of Object.entries(r))n(e,t,!0);return e}e.s(["bitGet",()=>X,"bitLen",()=>J,"bitMask",0,Y,"bitSet",0,(e,t,r)=>e|(r?R:O)<<BigInt(t),"bytesToHex",()=>H,"bytesToNumberBE",()=>j,"bytesToNumberLE",()=>V,"concatBytes",()=>Z,"createHmacDrbg",()=>ee,"ensureBytes",()=>W,"equalBytes",()=>K,"hexToBytes",()=>M,"hexToNumber",()=>q,"numberToBytesBE",()=>z,"numberToBytesLE",()=>D,"numberToHexUnpadded",()=>C,"numberToVarBytesBE",()=>F,"utf8ToBytes",()=>G,"validateObject",()=>er],7487);let en=BigInt(0),ei=BigInt(1),eo=BigInt(2),es=BigInt(3),ea=BigInt(4),el=BigInt(5),eu=BigInt(8);function ec(e,t){let r=e%t;return r>=en?r:t+r}function eh(e,t,r){let n=e;for(;t-- >en;)n*=n,n%=r;return n}function ef(e,t){if(e===en||t<=en)throw Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=ec(e,t),n=t,i=en,o=ei,s=ei,a=en;for(;r!==en;){let e=n/r,t=n%r,l=i-s*e,u=o-a*e;n=r,r=t,i=s,o=a,s=l,a=u}if(n!==ei)throw Error("invert: does not exist");return ec(i,t)}BigInt(9),BigInt(16);let ed=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ep(e){return er(e,ed.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function eg(e,t){let r=void 0!==t?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function ey(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function eb(e){let t=ey(e);return t+Math.ceil(t/2)}var em=e.i(7487);let ew=BigInt(0),eE=BigInt(1);function ex(e){return ep(e.Fp),er(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...eg(e.n,e.nBitLength),...e,...{p:e.Fp.ORDER}})}let{bytesToNumberBE:ev,hexToBytes:eA}=em,eS={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){let{Err:t}=eS;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(128&n[0])throw new t("Invalid signature integer: negative");if(0===n[0]&&!(128&n[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:ev(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=eS,r="string"==typeof e?eA(e):e;if(!(r instanceof Uint8Array))throw Error("ui8a expected");let n=r.length;if(n<2||48!=r[0])throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:o}=eS._parseInt(r.subarray(2)),{d:s,l:a}=eS._parseInt(o);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(e){let t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,r=e=>{let t=e.toString(16);return 1&t.length?`0${t}`:t},n=t(r(e.s)),i=t(r(e.r)),o=n.length/2,s=i.length/2,a=r(o),l=r(s);return`30${r(s+o+4)}02${l}${i}02${a}${n}`}},eU=BigInt(0),eB=BigInt(1),eI=BigInt(2),ek=BigInt(3),eN=BigInt(4);class eT extends A{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");y(e.outputLen),y(e.blockLen)}(e);const r=v(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return m(this),this.iHash.update(e),this}digestInto(e){m(this),b(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let eL=(e,t,r)=>new eT(e,t).update(r).digest();eL.create=(e,t)=>new eT(e,t);let e_=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),eO=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),eR=BigInt(1),e$=BigInt(2),eP=(e,t)=>(e+t/e$)/t;function eH(e){let t=BigInt(3),r=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),s=BigInt(44),a=BigInt(88),l=e*e*e%e_,u=l*l*e%e_,c=eh(u,t,e_)*u%e_,h=eh(c,t,e_)*u%e_,f=eh(h,e$,e_)*l%e_,d=eh(f,n,e_)*f%e_,p=eh(d,i,e_)*d%e_,g=eh(p,s,e_)*p%e_,y=eh(g,a,e_)*g%e_,b=eh(y,s,e_)*p%e_,m=eh(b,t,e_)*u%e_,w=eh(m,o,e_)*d%e_,E=eh(w,r,e_)*l%e_,x=eh(E,e$,e_);if(!eC.eql(eC.sqr(x),e))throw Error("Cannot find square root");return x}let eC=function(e,t,r=!1,n={}){if(e<=en)throw Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:o}=eg(e,t);if(o>2048)throw Error("Field lengths over 2048 bytes are not supported");let s=function(e){if(e%ea===es){let t=(e+ei)/ea;return function(e,r){let n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw Error("Cannot find square root");return n}}if(e%eu===el){let t=(e-el)/eu;return function(e,r){let n=e.mul(r,eo),i=e.pow(n,t),o=e.mul(r,i),s=e.mul(e.mul(o,eo),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),r))throw Error("Cannot find square root");return a}}return function(e){let t,r,n,i=(e-ei)/eo;for(t=e-ei,r=0;t%eo===en;t/=eo,r++);for(n=eo;n<e&&function(e,t,r){if(r<=en||t<en)throw Error("Expected power/modulo > 0");if(r===ei)return en;let n=ei;for(;t>en;)t&ei&&(n=n*e%r),e=e*e%r,t>>=ei;return n}(n,i,e)!==e-ei;n++);if(1===r){let t=(e+ei)/ea;return function(e,r){let n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw Error("Cannot find square root");return n}}let o=(t+ei)/eo;return function(e,s){if(e.pow(s,i)===e.neg(e.ONE))throw Error("Cannot find square root");let a=r,l=e.pow(e.mul(e.ONE,n),t),u=e.pow(s,o),c=e.pow(s,t);for(;!e.eql(c,e.ONE);){if(e.eql(c,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(c);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(l,ei<<BigInt(a-t-1));l=e.sqr(r),u=e.mul(u,r),c=e.mul(c,l),a=t}return u}}(e)}(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:o,MASK:Y(i),ZERO:en,ONE:ei,create:t=>ec(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error(`Invalid field element: expected bigint, got ${typeof t}`);return en<=t&&t<e},is0:e=>e===en,isOdd:e=>(e&ei)===ei,neg:t=>ec(-t,e),eql:(e,t)=>e===t,sqr:t=>ec(t*t,e),add:(t,r)=>ec(t+r,e),sub:(t,r)=>ec(t-r,e),mul:(t,r)=>ec(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<en)throw Error("Expected power > 0");if(r===en)return e.ONE;if(r===ei)return t;let n=e.ONE,i=t;for(;r>en;)r&ei&&(n=e.mul(n,i)),i=e.sqr(i),r>>=ei;return n})(a,e,t),div:(t,r)=>ec(t*ef(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>ef(t,e),sqrt:n.sqrt||(e=>s(a,e)),invertBatch:e=>{let t,r,n;return t=Array(e.length),r=e.reduce((e,r,n)=>a.is0(r)?e:(t[n]=e,a.mul(e,r)),a.ONE),n=a.inv(r),e.reduceRight((e,r,n)=>a.is0(r)?e:(t[n]=a.mul(e,t[n]),a.mul(e,r)),n),t},cmov:(e,t,r)=>r?t:e,toBytes:e=>r?D(e,o):z(e,o),fromBytes:e=>{if(e.length!==o)throw Error(`Fp.fromBytes: expected ${o}, got ${e.length}`);return r?V(e):j(e)}});return Object.freeze(a)}(e_,void 0,void 0,{sqrt:eH}),eq=(l={a:BigInt(0),b:BigInt(7),Fp:eC,n:eO,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-eR*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=BigInt("0x100000000000000000000000000000000"),o=eP(t*e,eO),s=eP(-r*e,eO),a=ec(e-o*t-s*n,eO),l=ec(-o*r-s*t,eO),u=a>i,c=l>i;if(u&&(a=eO-a),c&&(l=eO-l),a>i||l>i)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:u,k1:a,k2neg:c,k2:l}}}},Object.freeze({...(n=e=>(function(e){let t,r=(t=ex(e),em.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})),{Fp:n,n:i}=r,o=n.BYTES+1,s=2*n.BYTES+1;function a(e){return ec(e,i)}let{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:c,isWithinCurveOrder:h}=function(e){var t;let r,n,i=function(e){let t=ex(e);em.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:o}=i,s=i.toBytes||((e,t,r)=>{let n=t.toAffine();return em.concatBytes(Uint8Array.from([4]),o.toBytes(n.x),o.toBytes(n.y))}),a=i.fromBytes||(e=>{let t=e.subarray(1);return{x:o.fromBytes(t.subarray(0,o.BYTES)),y:o.fromBytes(t.subarray(o.BYTES,2*o.BYTES))}});function l(e){let{a:t,b:r}=i,n=o.sqr(e),s=o.mul(n,e);return o.add(o.add(s,o.mul(e,t)),r)}if(!o.eql(o.sqr(i.Gy),l(i.Gx)))throw Error("bad generator point: equation left != right");function u(e){return"bigint"==typeof e&&eU<e&&e<i.n}function c(e){if(!u(e))throw Error("Expected valid bigint: 0 < bigint < curve.n")}function h(e){let t,{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:o,n:s}=i;if(r&&"bigint"!=typeof e){if(e instanceof Uint8Array&&(e=em.bytesToHex(e)),"string"!=typeof e||!r.includes(e.length))throw Error("Invalid key");e=e.padStart(2*n,"0")}try{t="bigint"==typeof e?e:em.bytesToNumberBE(W("private key",e,n))}catch(t){throw Error(`private key must be ${n} bytes, hex or bigint, not ${typeof e}`)}return o&&(t=ec(t,s)),c(t),t}let f=new Map;function d(e){if(!(e instanceof p))throw Error("ProjectivePoint expected")}class p{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!o.isValid(e))throw Error("x required");if(null==t||!o.isValid(t))throw Error("y required");if(null==r||!o.isValid(r))throw Error("z required")}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!o.isValid(t)||!o.isValid(r))throw Error("invalid affine point");if(e instanceof p)throw Error("projective point not allowed");let n=e=>o.eql(e,o.ZERO);return n(t)&&n(r)?p.ZERO:new p(t,r,o.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=o.invertBatch(e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(p.fromAffine)}static fromHex(e){let t=p.fromAffine(a(W("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return p.BASE.multiply(h(e))}_setWindowSize(e){this._WINDOW_SIZE=e,f.delete(this)}assertValidity(){if(this.is0()){if(i.allowInfinityPoint&&!o.is0(this.py))return;throw Error("bad point: ZERO")}let{x:e,y:t}=this.toAffine();if(!o.isValid(e)||!o.isValid(t))throw Error("bad point: x or y not FE");let r=o.sqr(t),n=l(e);if(!o.eql(r,n))throw Error("bad point: equation left != right");if(!this.isTorsionFree())throw Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:e}=this.toAffine();if(o.isOdd)return!o.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){d(e);let{px:t,py:r,pz:n}=this,{px:i,py:s,pz:a}=e,l=o.eql(o.mul(t,a),o.mul(i,n)),u=o.eql(o.mul(r,a),o.mul(s,n));return l&&u}negate(){return new p(this.px,o.neg(this.py),this.pz)}double(){let{a:e,b:t}=i,r=o.mul(t,ek),{px:n,py:s,pz:a}=this,l=o.ZERO,u=o.ZERO,c=o.ZERO,h=o.mul(n,n),f=o.mul(s,s),d=o.mul(a,a),g=o.mul(n,s);return g=o.add(g,g),c=o.mul(n,a),c=o.add(c,c),l=o.mul(e,c),u=o.mul(r,d),u=o.add(l,u),l=o.sub(f,u),u=o.add(f,u),u=o.mul(l,u),l=o.mul(g,l),c=o.mul(r,c),d=o.mul(e,d),g=o.sub(h,d),g=o.mul(e,g),g=o.add(g,c),c=o.add(h,h),h=o.add(c,h),h=o.add(h,d),h=o.mul(h,g),u=o.add(u,h),d=o.mul(s,a),d=o.add(d,d),h=o.mul(d,g),l=o.sub(l,h),c=o.mul(d,f),c=o.add(c,c),new p(l,u,c=o.add(c,c))}add(e){d(e);let{px:t,py:r,pz:n}=this,{px:s,py:a,pz:l}=e,u=o.ZERO,c=o.ZERO,h=o.ZERO,f=i.a,g=o.mul(i.b,ek),y=o.mul(t,s),b=o.mul(r,a),m=o.mul(n,l),w=o.add(t,r),E=o.add(s,a);w=o.mul(w,E),E=o.add(y,b),w=o.sub(w,E),E=o.add(t,n);let x=o.add(s,l);return E=o.mul(E,x),x=o.add(y,m),E=o.sub(E,x),x=o.add(r,n),u=o.add(a,l),x=o.mul(x,u),u=o.add(b,m),x=o.sub(x,u),h=o.mul(f,E),u=o.mul(g,m),h=o.add(u,h),u=o.sub(b,h),h=o.add(b,h),c=o.mul(u,h),b=o.add(y,y),b=o.add(b,y),m=o.mul(f,m),E=o.mul(g,E),b=o.add(b,m),m=o.sub(y,m),m=o.mul(f,m),E=o.add(E,m),y=o.mul(b,E),c=o.add(c,y),y=o.mul(x,E),u=o.mul(w,u),u=o.sub(u,y),y=o.mul(w,b),h=o.mul(x,h),new p(u,c,h=o.add(h,y))}subtract(e){return this.add(e.negate())}is0(){return this.equals(p.ZERO)}wNAF(e){return y.wNAFCached(this,f,e,e=>{let t=o.invertBatch(e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(p.fromAffine)})}multiplyUnsafe(e){let t=p.ZERO;if(e===eU)return t;if(c(e),e===eB)return this;let{endo:r}=i;if(!r)return y.unsafeLadder(this,e);let{k1neg:n,k1:s,k2neg:a,k2:l}=r.splitScalar(e),u=t,h=t,f=this;for(;s>eU||l>eU;)s&eB&&(u=u.add(f)),l&eB&&(h=h.add(f)),f=f.double(),s>>=eB,l>>=eB;return n&&(u=u.negate()),a&&(h=h.negate()),h=new p(o.mul(h.px,r.beta),h.py,h.pz),u.add(h)}multiply(e){let t,r;c(e);let{endo:n}=i;if(n){let{k1neg:i,k1:s,k2neg:a,k2:l}=n.splitScalar(e),{p:u,f:c}=this.wNAF(s),{p:h,f:f}=this.wNAF(l);u=y.constTimeNegate(i,u),h=y.constTimeNegate(a,h),h=new p(o.mul(h.px,n.beta),h.py,h.pz),t=u.add(h),r=c.add(f)}else{let{p:n,f:i}=this.wNAF(e);t=n,r=i}return p.normalizeZ([t,r])[0]}multiplyAndAddUnsafe(e,t,r){let n=p.BASE,i=(e,t)=>t!==eU&&t!==eB&&e.equals(n)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,r));return o.is0()?void 0:o}toAffine(e){let{px:t,py:r,pz:n}=this,i=this.is0();null==e&&(e=i?o.ONE:o.inv(n));let s=o.mul(t,e),a=o.mul(r,e),l=o.mul(n,e);if(i)return{x:o.ZERO,y:o.ZERO};if(!o.eql(l,o.ONE))throw Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){let{h:e,isTorsionFree:t}=i;if(e===eB)return!0;if(t)return t(p,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:e,clearCofactor:t}=i;return e===eB?this:t?t(p,this):this.multiplyUnsafe(i.h)}toRawBytes(e=!0){return this.assertValidity(),s(p,this,e)}toHex(e=!0){return em.bytesToHex(this.toRawBytes(e))}}p.BASE=new p(i.Gx,i.Gy,o.ONE),p.ZERO=new p(o.ZERO,o.ONE,o.ZERO);let g=i.nBitLength,y=(t=i.endo?Math.ceil(g/2):g,r=(e,t)=>{let r=t.negate();return e?r:t},n=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}),{constTimeNegate:r,unsafeLadder(e,t){let r=p.ZERO,n=e;for(;t>ew;)t&eE&&(r=r.add(n)),n=n.double(),t>>=eE;return r},precomputeWindow(e,t){let{windows:r,windowSize:i}=n(t),o=[],s=e,a=s;for(let e=0;e<r;e++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(e,t,i){let{windows:o,windowSize:s}=n(e),a=p.ZERO,l=p.BASE,u=BigInt(2**e-1),c=2**e,h=BigInt(e);for(let e=0;e<o;e++){let n=e*s,o=Number(i&u);i>>=h,o>s&&(o-=c,i+=eE);let f=n+Math.abs(o)-1,d=e%2!=0,p=o<0;0===o?l=l.add(r(d,t[n])):a=a.add(r(p,t[f]))}return{p:a,f:l}},wNAFCached(e,t,r,n){let i=e._WINDOW_SIZE||1,o=t.get(e);return o||(o=this.precomputeWindow(e,i),1!==i&&t.set(e,n(o))),this.wNAF(i,o,r)}});return{CURVE:i,ProjectivePoint:p,normPrivateKeyToScalar:h,weierstrassEquation:l,isWithinCurveOrder:u}}({...r,toBytes(e,t,r){let i=t.toAffine(),o=n.toBytes(i.x),s=em.concatBytes;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes(e){let t=e.length,r=e[0],i=e.subarray(1);if(t===o&&(2===r||3===r)){let e=em.bytesToNumberBE(i);if(!(eU<e&&e<n.ORDER))throw Error("Point is not on curve");let t=c(e),o=n.sqrt(t);return(1&r)==1!=((o&eB)===eB)&&(o=n.neg(o)),{x:e,y:o}}if(t===s&&4===r)return{x:n.fromBytes(i.subarray(0,n.BYTES)),y:n.fromBytes(i.subarray(n.BYTES,2*n.BYTES))};throw Error(`Point of length ${t} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),f=e=>em.bytesToHex(em.numberToBytesBE(e,r.nByteLength)),d=(e,t,r)=>em.bytesToNumberBE(e.slice(t,r));class p{constructor(e,t,r){this.r=e,this.s=t,this.recovery=r,this.assertValidity()}static fromCompact(e){let t=r.nByteLength;return new p(d(e=W("compactSignature",e,2*t),0,t),d(e,t,2*t))}static fromDER(e){let{r:t,s:r}=eS.toSig(W("DER",e));return new p(t,r)}assertValidity(){if(!h(this.r))throw Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new p(this.r,this.s,e)}recoverPublicKey(e){let{r:t,s:o,recovery:s}=this,u=b(W("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let c=2===s||3===s?t+r.n:t;if(c>=n.ORDER)throw Error("recovery id 2 or 3 invalid");let h=(1&s)==0?"02":"03",d=l.fromHex(h+f(c)),p=ef(c,i),g=a(-u*p),y=a(o*p),m=l.BASE.multiplyAndAddUnsafe(d,g,y);if(!m)throw Error("point at infinify");return m.assertValidity(),m}hasHighS(){return this.s>i>>eB}normalizeS(){return this.hasHighS()?new p(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return em.hexToBytes(this.toDERHex())}toDERHex(){return eS.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return em.hexToBytes(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}function g(e){let t=e instanceof Uint8Array,r="string"==typeof e,n=(t||r)&&e.length;return t?n===o||n===s:r?n===2*o||n===2*s:e instanceof l}let y=r.bits2int||function(e){let t=em.bytesToNumberBE(e),n=8*e.length-r.nBitLength;return n>0?t>>BigInt(n):t},b=r.bits2int_modN||function(e){return a(y(e))},m=em.bitMask(r.nBitLength);function w(e){if("bigint"!=typeof e)throw Error("bigint expected");if(!(eU<=e&&e<m))throw Error(`bigint expected < 2^${r.nBitLength}`);return em.numberToBytesBE(e,r.nByteLength)}let E={lowS:r.lowS,prehash:!1},x={lowS:r.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(e,t=!0){return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(g(e))throw Error("first arg must be private key");if(!g(t))throw Error("second arg must be public key");return l.fromHex(t).multiply(u(e)).toRawBytes(r)},sign:function(e,t,o=E){let{seed:s,k2sig:c}=function(e,t,o=E){if(["recovered","canonical"].some(e=>e in o))throw Error("sign() legacy options not supported");let{hash:s,randomBytes:c}=r,{lowS:f,prehash:d,extraEntropy:g}=o;null==f&&(f=!0),e=W("msgHash",e),d&&(e=W("prehashed msgHash",s(e)));let m=b(e),x=u(t),v=[w(x),w(m)];if(null!=g){let e=!0===g?c(n.BYTES):g;v.push(W("extraEntropy",e))}return{seed:em.concatBytes(...v),k2sig:function(e){var t;let r=y(e);if(!h(r))return;let n=ef(r,i),o=l.BASE.multiply(r).toAffine(),s=a(o.x);if(s===eU)return;let u=a(n*a(m+s*x));if(u===eU)return;let c=2*(o.x!==s)|Number(o.y&eB),d=u;return f&&u>i>>eB&&(d=(t=u)>i>>eB?a(-t):t,c^=1),new p(s,d,c)}}}(e,t,o);return em.createHmacDrbg(r.hash.outputLen,r.nByteLength,r.hmac)(s,c)},verify:function(e,t,n,o=x){let s,u;if(t=W("msgHash",t),n=W("publicKey",n),"strict"in o)throw Error("options.strict was renamed to lowS");let{lowS:c,prehash:h}=o;try{if("string"==typeof e||e instanceof Uint8Array)try{u=p.fromDER(e)}catch(t){if(!(t instanceof eS.Err))throw t;u=p.fromCompact(e)}else if("object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s){let{r:t,s:r}=e;u=new p(t,r)}else throw Error("PARSE");s=l.fromHex(n)}catch(e){if("PARSE"===e.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(c&&u.hasHighS())return!1;h&&(t=r.hash(t));let{r:f,s:d}=u,g=b(t),y=ef(d,i),m=a(g*y),w=a(f*y),E=l.BASE.multiplyAndAddUnsafe(s,m,w)?.toAffine();return!!E&&a(E.x)===f},ProjectivePoint:l,Signature:p,utils:{isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let e=eb(r.n);return function(e,t,r=!1){let n=e.length,i=ey(t),o=eb(t);if(n<16||n<o||n>1024)throw Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=ec(r?j(e):V(e),t-ei)+ei;return r?D(s,i):z(s,i)}(r.randomBytes(e),r.n)},precompute:(e=8,t=l.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}})({...l,hash:e,hmac:(t,...r)=>eL(e,t,function(...e){let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),r=0;return e.forEach(e=>{if(!(e instanceof Uint8Array))throw Error("Uint8Array expected");t.set(e,r),r+=e.length}),t}(...r)),randomBytes:S}))(_),create:n})),eM=BigInt(0),ej=e=>"bigint"==typeof e&&eM<e&&e<e_,eV={};function ez(e,...t){let r=eV[e];if(void 0===r){let t=_(Uint8Array.from(e,e=>e.charCodeAt(0)));r=Z(t,t),eV[e]=r}return _(Z(r,...t))}let eD=e=>e.toRawBytes(!0).slice(1),eF=eq.ProjectivePoint;function eW(e){let t=eq.utils.normPrivateKeyToScalar(e),r=eF.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:ec(-t,eO),bytes:eD(r)}}function eZ(e){if(!ej(e))throw Error("bad x: need 0 < x < p");let t=ec(e*e,e_),r=eH(ec(t*e+BigInt(7),e_));r%e$!==eM&&(r=ec(-r,e_));let n=new eF(e,r,eR);return n.assertValidity(),n}function eK(...e){return ec(j(ez("BIP0340/challenge",...e)),eO)}function eG(e,t,r){let n=W("signature",e,64),i=W("message",t),o=W("publicKey",r,32);try{let e,t,r=eZ(j(o)),s=j(n.subarray(0,32));if(!ej(s))return!1;let a=j(n.subarray(32,64));if("bigint"!=typeof a||!(eM<a)||!(a<eO))return!1;let l=eK(z(s,32),eD(r),i),u=(e=-l,t=ec(e,eO),eF.BASE.multiplyAndAddUnsafe(r,a,t));if(!u||!u.hasEvenY()||u.toAffine().x!==s)return!1;return!0}catch(e){return!1}}let eJ={getPublicKey:function(e){return eW(e).bytes},sign:function(e,t,r=S(32)){let n=W("message",e),{bytes:i,scalar:o}=eW(t),s=z(o^j(ez("BIP0340/aux",W("auxRand",r,32))),32),a=ec(j(ez("BIP0340/nonce",s,i,n)),eO);if(a===eM)throw Error("sign failed: k is zero");let{bytes:l,scalar:u}=eW(a),c=eK(l,i,n),h=new Uint8Array(64);if(h.set(l,0),h.set(z(ec(u+c*o,eO),32),32),!eG(h,n,i))throw Error("sign: Invalid signature produced");return h},verify:eG,utils:{randomPrivateKey:eq.utils.randomPrivateKey,lift_x:eZ,pointToBytes:eD,numberToBytesBE:z,bytesToNumberBE:j,taggedHash:ez,mod:ec}},eX=(i=[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e))).map(e=>Array.from(e).reverse()),(e,t)=>{let[r,n,o,s]=i.map(t=>t.reduce((t,r)=>eC.add(eC.mul(t,e),r)));return e=eC.div(r,n),t=eC.mul(t,eC.div(o,s)),{x:e,y:t}}),eY=function(e,t){if(ep(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let r=function(e,t){let r=e.ORDER,n=eU;for(let e=r-eB;e%eI===eU;e/=eI)n+=eB;let i=n,o=eI<<i-eB-eB,s=o*eI,a=(r-eB)/s,l=(a-eB)/eI,u=s-eB,c=e.pow(t,a),h=e.pow(t,(a+eB)/eI),f=(t,r)=>{let n=c,s=e.pow(r,u),a=e.sqr(s);a=e.mul(a,r);let f=e.mul(t,a);f=e.pow(f,l),f=e.mul(f,s),s=e.mul(f,r),a=e.mul(f,t);let d=e.mul(a,s);f=e.pow(d,o);let p=e.eql(f,e.ONE);s=e.mul(a,h),f=e.mul(d,n),a=e.cmov(s,a,p),d=e.cmov(f,d,p);for(let t=i;t>eB;t--){let r=t-eI;r=eI<<r-eB;let i=e.pow(d,r),o=e.eql(i,e.ONE);s=e.mul(a,n),n=e.mul(n,n),i=e.mul(d,n),a=e.cmov(s,a,o),d=e.cmov(i,d,o)}return{isValid:p,value:a}};if(e.ORDER%eN===ek){let r=(e.ORDER-ek)/eN,n=e.sqrt(e.neg(t));f=(t,i)=>{let o=e.sqr(i),s=e.mul(t,i);o=e.mul(o,s);let a=e.pow(o,r);a=e.mul(a,s);let l=e.mul(a,n),u=e.mul(e.sqr(a),i),c=e.eql(u,t),h=e.cmov(l,a,c);return{isValid:c,value:h}}}return f}(e,t.Z);if(!e.isOdd)throw Error("Fp.isOdd is not implemented!");return n=>{let i,o,s,a,l,u,c,h;i=e.sqr(n),i=e.mul(i,t.Z),o=e.sqr(i),o=e.add(o,i),s=e.add(o,e.ONE),s=e.mul(s,t.B),a=e.cmov(t.Z,e.neg(o),!e.eql(o,e.ZERO)),a=e.mul(a,t.A),o=e.sqr(s),u=e.sqr(a),l=e.mul(u,t.A),o=e.add(o,l),o=e.mul(o,s),u=e.mul(u,a),l=e.mul(u,t.B),o=e.add(o,l),c=e.mul(i,s);let{isValid:f,value:d}=r(o,u);h=e.mul(i,n),h=e.mul(h,d),c=e.cmov(c,s,f),h=e.cmov(h,d,f);let p=e.isOdd(n)===e.isOdd(h);return h=e.cmov(e.neg(h),h,p),{x:c=e.div(c,a),y:h}}}(eC,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:eC.create(BigInt("-11"))});!function(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined")}(eq.ProjectivePoint,e=>{let{x:t,y:r}=eY(eC.create(e[0]));return eX(t,r)},eC.ORDER);let eQ="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,e0=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),e1=(e,t)=>e<<32-t|e>>>t;if(68!==new Uint8Array(new Uint32Array([0x11223344]).buffer)[0])throw Error("Non little-endian hardware is not supported");let e2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function e3(e){if(!(e instanceof Uint8Array))throw Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=e2[e[r]];return t}function e8(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(t/2);for(let t=0;t<r.length;t++){let n=2*t,i=Number.parseInt(e.slice(n,n+2),16);if(Number.isNaN(i)||i<0)throw Error("Invalid byte sequence");r[t]=i}return r}function e6(e){if("string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}(e)),!(e instanceof Uint8Array))throw Error(`expected Uint8Array, got ${typeof e}`);return e}function e4(...e){let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),r=0;return e.forEach(e=>{if(!(e instanceof Uint8Array))throw Error("Uint8Array expected");t.set(e,r),r+=e.length}),t}class e5{clone(){return this._cloneInto()}}function e9(e){let t=t=>e().update(e6(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function e7(e=32){if(eQ&&"function"==typeof eQ.getRandomValues)return eQ.getRandomValues(new Uint8Array(e));throw Error("crypto.getRandomValues must be defined")}function te(e){if(!Number.isSafeInteger(e)||e<0)throw Error(`Wrong positive integer: ${e}`)}function tt(e,...t){if(!(e instanceof Uint8Array))throw Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}let tr=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");te(e.outputLen),te(e.blockLen)},tn=function(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")},ti=function(e,t){tt(e);let r=t.outputLen;if(e.length<r)throw Error(`digestInto() expects output buffer of length at least ${r}`)};class to extends e5{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=e0(this.buffer)}update(e){tn(this);let{view:t,buffer:r,blockLen:n}=this,i=(e=e6(e)).length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){let t=e0(e);for(;n<=i-o;o+=n)this.process(t,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){tn(this),ti(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:n,isLE:i}=this,{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);let i=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>i&o),a=Number(r&o),l=4*!!n,u=4*!n;e.setUint32(t+l,s,n),e.setUint32(t+u,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);let s=e0(e),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=a/4,u=this.get();if(l>u.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<l;e++)s.setUint32(4*e,u[e],i)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return e.length=n,e.pos=s,e.finished=i,e.destroyed=o,n%t&&e.buffer.set(r),e}}let ts=(e,t,r)=>e&t^~e&r,ta=(e,t,r)=>e&t^e&r^t&r,tl=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),tu=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),tc=new Uint32Array(64);class th extends to{constructor(){super(64,32,8,!1),this.A=0|tu[0],this.B=0|tu[1],this.C=0|tu[2],this.D=0|tu[3],this.E=0|tu[4],this.F=0|tu[5],this.G=0|tu[6],this.H=0|tu[7]}get(){let{A:e,B:t,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[e,t,r,n,i,o,s,a]}set(e,t,r,n,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)tc[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=tc[e-15],r=tc[e-2],n=e1(t,7)^e1(t,18)^t>>>3,i=e1(r,17)^e1(r,19)^r>>>10;tc[e]=i+tc[e-7]+n+tc[e-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:l,H:u}=this;for(let e=0;e<64;e++){let t=u+(e1(s,6)^e1(s,11)^e1(s,25))+ts(s,a,l)+tl[e]+tc[e]|0,c=(e1(r,2)^e1(r,13)^e1(r,22))+ta(r,n,i)|0;u=l,l=a,a=s,s=o+t|0,o=i,i=n,n=r,r=t+c|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,l,u)}roundClean(){tc.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class tf extends th{constructor(){super(),this.A=-0x3efa6128,this.B=0x367cd507,this.C=0x3070dd17,this.D=-0x8f1a6c7,this.E=-4191439,this.F=0x68581511,this.G=0x64f98fa7,this.H=-0x4105b05c,this.outputLen=28}}let td=e9(()=>new th);function tp(e){if(!Number.isSafeInteger(e))throw Error(`Wrong integer: ${e}`)}function tg(...e){let t=(e,t)=>r=>e(t(r));return{encode:Array.from(e).reverse().reduce((e,r)=>e?t(e,r.encode):r.encode,void 0),decode:e.reduce((e,r)=>e?t(e,r.decode):r.decode,void 0)}}function ty(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw Error("alphabet.encode input should be an array of numbers");return t.map(t=>{if(tp(t),t<0||t>=e.length)throw Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]})},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw Error("alphabet.decode input should be array of strings");return t.map(t=>{if("string"!=typeof t)throw Error(`alphabet.decode: not string element=${t}`);let r=e.indexOf(t);if(-1===r)throw Error(`Unknown letter: "${t}". Allowed: ${e}`);return r})}}}function tb(e=""){if("string"!=typeof e)throw Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw Error("join.decode input should be string");return t.split(e)}}}function tm(e,t="="){if(tp(e),"string"!=typeof t)throw Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&"string"!=typeof r[0])throw Error("padding.encode input should be array of strings");for(let e of r)if("string"!=typeof e)throw Error(`padding.encode: non-string input=${e}`);for(;r.length*e%8;)r.push(t);return r},decode(r){if(!Array.isArray(r)||r.length&&"string"!=typeof r[0])throw Error("padding.encode input should be array of strings");for(let e of r)if("string"!=typeof e)throw Error(`padding.decode: non-string input=${e}`);let n=r.length;if(n*e%8)throw Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if(!((n-1)*e%8))throw Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function tw(e){if("function"!=typeof e)throw Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function tE(e,t,r){if(t<2)throw Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(r<2)throw Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw Error("convertRadix: data should be array");if(!e.length)return[];let n=0,i=[],o=Array.from(e);for(o.forEach(e=>{if(tp(e),e<0||e>=t)throw Error(`Wrong integer: ${e}`)});;){let e=0,s=!0;for(let i=n;i<o.length;i++){let a=o[i],l=t*e+a;if(!Number.isSafeInteger(l)||t*e/t!==e||l-a!=t*e||(e=l%r,o[i]=Math.floor(l/r),!Number.isSafeInteger(o[i])||o[i]*r+e!==l))throw Error("convertRadix: carry overflow");s&&(o[i]?s=!1:n=i)}if(i.push(e),s)break}for(let t=0;t<e.length-1&&0===e[t];t++)i.push(0);return i.reverse()}e9(()=>new tf);let tx=(e,t)=>t?tx(t,e%t):e,tv=(e,t)=>e+(t-tx(e,t));function tA(e,t,r,n){if(!Array.isArray(e))throw Error("convertRadix2: data should be array");if(t<=0||t>32)throw Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw Error(`convertRadix2: wrong to=${r}`);if(tv(t,r)>32)throw Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${tv(t,r)}`);let i=0,o=0,s=2**r-1,a=[];for(let n of e){if(tp(n),n>=2**t)throw Error(`convertRadix2: invalid data word=${n} from=${t}`);if(i=i<<t|n,o+t>32)throw Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=r;o-=r)a.push((i>>o-r&s)>>>0);i&=2**o-1}if(i=i<<r-o&s,!n&&o>=t)throw Error("Excess padding");if(!n&&i)throw Error(`Non-zero padding: ${i}`);return n&&o>0&&a.push(i>>>0),a}function tS(e,t=!1){if(tp(e),e<=0||e>32)throw Error("radix2: bits should be in (0..32]");if(tv(8,e)>32||tv(e,8)>32)throw Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw Error("radix2.encode input should be Uint8Array");return tA(Array.from(r),8,e,!t)},decode:r=>{if(!Array.isArray(r)||r.length&&"number"!=typeof r[0])throw Error("radix2.decode input should be array of strings");return Uint8Array.from(tA(r,e,8,t))}}}function tU(e){if("function"!=typeof e)throw Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch(e){}}}tg(tS(4),ty("0123456789ABCDEF"),tb("")),tg(tS(5),ty("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),tm(5),tb("")),tg(tS(5),ty("0123456789ABCDEFGHIJKLMNOPQRSTUV"),tm(5),tb("")),tg(tS(5),ty("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),tb(""),tw(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));let tB=tg(tS(6),ty("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),tm(6),tb("")),tI=(tg(tS(6),ty("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),tm(6),tb("")),e=>tg((tp(58),{encode:e=>{if(!(e instanceof Uint8Array))throw Error("radix.encode input should be Uint8Array");return tE(Array.from(e),256,58)},decode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw Error("radix.decode input should be array of strings");return Uint8Array.from(tE(e,58,256))}}),ty(e),tb("")));tI("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),tI("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),tI("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");let tk=tg(ty("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),tb("")),tN=[0x3b6a57b2,0x26508e6d,0x1ea119fa,0x3d4233dd,0x2a1462b3];function tT(e){let t=e>>25,r=(0x1ffffff&e)<<5;for(let e=0;e<tN.length;e++)(t>>e&1)==1&&(r^=tN[e]);return r}function tL(e,t,r=1){let n=e.length,i=1;for(let t=0;t<n;t++){let r=e.charCodeAt(t);if(r<33||r>126)throw Error(`Invalid prefix (${e})`);i=tT(i)^r>>5}i=tT(i);for(let t=0;t<n;t++)i=tT(i)^31&e.charCodeAt(t);for(let e of t)i=tT(i)^e;for(let e=0;e<6;e++)i=tT(i);return i^=r,tk.encode(tA([i%0x40000000],30,5,!1))}function t_(e){let t="bech32"===e?1:0x2bc830a3,r=tS(5),n=r.decode,i=r.encode,o=tU(n);function s(e,r=90){if("string"!=typeof e)throw Error(`bech32.decode input should be string, not ${typeof e}`);if(e.length<8||!1!==r&&e.length>r)throw TypeError(`Wrong string length: ${e.length} (${e}). Expected (8..${r})`);let n=e.toLowerCase();if(e!==n&&e!==e.toUpperCase())throw Error("String must be lowercase or uppercase");let i=(e=n).lastIndexOf("1");if(0===i||-1===i)throw Error('Letter "1" must be present between prefix and data only');let o=e.slice(0,i),a=e.slice(i+1);if(a.length<6)throw Error("Data must be at least 6 characters long");let l=tk.decode(a).slice(0,-6),u=tL(o,l,t);if(!a.endsWith(u))throw Error(`Invalid checksum in ${e}: expected "${u}"`);return{prefix:o,words:l}}let a=tU(s);return{encode:function(e,r,n=90){if("string"!=typeof e)throw Error(`bech32.encode prefix should be string, not ${typeof e}`);if(!Array.isArray(r)||r.length&&"number"!=typeof r[0])throw Error(`bech32.encode words should be array of numbers, not ${typeof r}`);let i=e.length+7+r.length;if(!1!==n&&i>n)throw TypeError(`Length ${i} exceeds limit ${n}`);return e=e.toLowerCase(),`${e}1${tk.encode(r)}${tL(e,r,t)}`},decode:s,decodeToBytes:function(e){let{prefix:t,words:r}=s(e,!1);return{prefix:t,words:r,bytes:n(r)}},decodeUnsafe:a,fromWords:n,fromWordsUnsafe:o,toWords:i}}let tO=t_("bech32");function tR(e){if(!Number.isSafeInteger(e)||e<0)throw Error(`positive integer expected, not ${e}`)}function t$(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}function tP(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function tH(e,...t){if(!tP(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function tC(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function tq(e,t){tH(e);let r=t.outputLen;if(e.length<r)throw Error(`digestInto() expects output buffer of length at least ${r}`)}t_("bech32m"),tg(tS(4),ty("0123456789abcdef"),tb(""),tw(e=>{if("string"!=typeof e||e.length%2)throw TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));let tM=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength),tj=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),tV=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(68!==new Uint8Array(new Uint32Array([0x11223344]).buffer)[0])throw Error("Non little-endian hardware is not supported");let tz=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tD(e){tH(e);let t="";for(let r=0;r<e.length;r++)t+=tz[e[r]];return t}function tF(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function tW(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw Error("padded hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){let r=tF(e.charCodeAt(i)),o=tF(e.charCodeAt(i+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(e[i]+e[i+1])+'" at index '+i);n[t]=16*r+o}return n}function tZ(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error(`string expected, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}(e);else if(tP(e))e=e.slice();else throw Error(`Uint8Array expected, got ${typeof e}`);return e}function tK(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}let tG=(e,t)=>(Object.assign(t,e),t);function tJ(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);let i=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>i&o),a=Number(r&o),l=4*!!n,u=4*!n;e.setUint32(t+l,s,n),e.setUint32(t+u,a,n)}let tX=new Uint8Array(16),tY=tj(tX),tQ=(e,t,r,n)=>({s3:r<<31|n>>>1,s2:t<<31|r>>>1,s1:e<<31|t>>>1,s0:e>>>1^-0x1f000000&-(1&n&1)}),t0=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;class t1{constructor(e,t){this.blockLen=16,this.outputLen=16,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,tH(e=tZ(e),16);const r=tV(e);let n=r.getUint32(0,!1),i=r.getUint32(4,!1),o=r.getUint32(8,!1),s=r.getUint32(12,!1);const a=[];for(let e=0;e<128;e++)a.push({s0:t0(n),s1:t0(i),s2:t0(o),s3:t0(s)}),{s0:n,s1:i,s2:o,s3:s}=tQ(n,i,o,s);const l=(e=>e>65536?8:e>1024?4:2)(t||1024);if(![1,2,4,8].includes(l))throw Error(`ghash: wrong window size=${l}, should be 2, 4 or 8`);this.W=l;const u=128/l,c=this.windowSize=2**l,h=[];for(let e=0;e<u;e++)for(let t=0;t<c;t++){let r=0,n=0,i=0,o=0;for(let s=0;s<l;s++){if(!(t>>>l-s-1&1))continue;const{s0:u,s1:c,s2:h,s3:f}=a[l*e+s];r^=u,n^=c,i^=h,o^=f}h.push({s0:r,s1:n,s2:i,s3:o})}this.t=h}_updateBlock(e,t,r,n){e^=this.s0,t^=this.s1,r^=this.s2,n^=this.s3;let{W:i,t:o,windowSize:s}=this,a=0,l=0,u=0,c=0,h=(1<<i)-1,f=0;for(let d of[e,t,r,n])for(let e=0;e<4;e++){let t=d>>>8*e&255;for(let e=8/i-1;e>=0;e--){let{s0:r,s1:n,s2:d,s3:p}=o[f*s+(t>>>i*e&h)];a^=r,l^=n,u^=d,c^=p,f+=1}}this.s0=a,this.s1=l,this.s2=u,this.s3=c}update(e){e=tZ(e),tC(this);let t=tj(e),r=Math.floor(e.length/16),n=e.length%16;for(let e=0;e<r;e++)this._updateBlock(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]);return n&&(tX.set(e.subarray(16*r)),this._updateBlock(tY[0],tY[1],tY[2],tY[3]),tY.fill(0)),this}destroy(){let{t:e}=this;for(let t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){tC(this),tq(e,this),this.finished=!0;let{s0:t,s1:r,s2:n,s3:i}=this,o=tj(e);return o[0]=t,o[1]=r,o[2]=n,o[3]=i,e}digest(){let e=new Uint8Array(16);return this.digestInto(e),this.destroy(),e}}class t2 extends t1{constructor(e,t){const r=function(e){e.reverse();let t=1&e[15],r=0;for(let t=0;t<e.length;t++){let n=e[t];e[t]=n>>>1|r,r=(1&n)<<7}return e[0]^=225&-t,e}((e=tZ(e)).slice());super(r,t),r.fill(0)}update(e){e=tZ(e),tC(this);let t=tj(e),r=e.length%16,n=Math.floor(e.length/16);for(let e=0;e<n;e++)this._updateBlock(t0(t[4*e+3]),t0(t[4*e+2]),t0(t[4*e+1]),t0(t[4*e+0]));return r&&(tX.set(e.subarray(16*n)),this._updateBlock(t0(tY[3]),t0(tY[2]),t0(tY[1]),t0(tY[0])),tY.fill(0)),this}digestInto(e){tC(this),tq(e,this),this.finished=!0;let{s0:t,s1:r,s2:n,s3:i}=this,o=tj(e);return o[0]=t,o[1]=r,o[2]=n,o[3]=i,e.reverse()}}function t3(e){let t=(t,r)=>e(r,t.length).update(tZ(t)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(t,r)=>e(t,r),t}let t8=t3((e,t)=>new t1(e,t)),t6=t3((e,t)=>new t2(e,t)),t4=new Uint8Array(16);function t5(e){return e<<1^283&-(e>>7)}function t9(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(1&t),e=t5(e);return r}let t7=(()=>{let e=new Uint8Array(256);for(let t=0,r=1;t<256;t++,r^=t5(r))e[t]=r;let t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return t})(),re=t7.map((e,t)=>t7.indexOf(t)),rt=e=>e<<24|e>>>8,rr=e=>e<<8|e>>>24;function rn(e,t){if(256!==e.length)throw Error("Wrong sbox length");let r=new Uint32Array(256).map((r,n)=>t(e[n])),n=r.map(rr),i=n.map(rr),o=i.map(rr),s=new Uint32Array(65536),a=new Uint32Array(65536),l=new Uint16Array(65536);for(let t=0;t<256;t++)for(let u=0;u<256;u++){let c=256*t+u;s[c]=r[t]^n[u],a[c]=i[t]^o[u],l[c]=e[t]<<8|e[u]}return{sbox:e,sbox2:l,T0:r,T1:n,T2:i,T3:o,T01:s,T23:a}}let ri=rn(t7,e=>t9(e,3)<<24|e<<16|e<<8|t9(e,2)),ro=rn(re,e=>t9(e,11)<<24|t9(e,13)<<16|t9(e,9)<<8|t9(e,14)),rs=(()=>{let e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=t5(r))e[t]=r;return e})();function ra(e){tH(e);let t=e.length;if(![16,24,32].includes(t))throw Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);let{sbox2:r}=ri,n=tj(e),i=n.length,o=e=>rc(r,e,e,e,e),s=new Uint32Array(t+28);s.set(n);for(let e=i;e<s.length;e++){let t=s[e-1];e%i==0?t=o(rt(t))^rs[e/i-1]:i>6&&e%i==4&&(t=o(t)),s[e]=s[e-i]^t}return s}function rl(e){let t=ra(e),r=t.slice(),n=t.length,{sbox2:i}=ri,{T0:o,T1:s,T2:a,T3:l}=ro;for(let e=0;e<n;e+=4)for(let i=0;i<4;i++)r[e+i]=t[n-e-4+i];t.fill(0);for(let e=4;e<n-4;e++){let t=r[e],n=rc(i,t,t,t,t);r[e]=o[255&n]^s[n>>>8&255]^a[n>>>16&255]^l[n>>>24]}return r}function ru(e,t,r,n,i,o){return e[r<<8&65280|n>>>8&255]^t[i>>>8&65280|o>>>24&255]}function rc(e,t,r,n,i){return e[255&t|65280&r]|e[n>>>16&255|i>>>16&65280]<<16}function rh(e,t,r,n,i){let{sbox2:o,T01:s,T23:a}=ri,l=0;t^=e[l++],r^=e[l++],n^=e[l++],i^=e[l++];let u=e.length/4-2;for(let o=0;o<u;o++){let o=e[l++]^ru(s,a,t,r,n,i),u=e[l++]^ru(s,a,r,n,i,t),c=e[l++]^ru(s,a,n,i,t,r),h=e[l++]^ru(s,a,i,t,r,n);t=o,r=u,n=c,i=h}return{s0:e[l++]^rc(o,t,r,n,i),s1:e[l++]^rc(o,r,n,i,t),s2:e[l++]^rc(o,n,i,t,r),s3:e[l++]^rc(o,i,t,r,n)}}function rf(e,t,r,n,i){let{sbox2:o,T01:s,T23:a}=ro,l=0;t^=e[l++],r^=e[l++],n^=e[l++],i^=e[l++];let u=e.length/4-2;for(let o=0;o<u;o++){let o=e[l++]^ru(s,a,t,i,n,r),u=e[l++]^ru(s,a,r,t,i,n),c=e[l++]^ru(s,a,n,r,t,i),h=e[l++]^ru(s,a,i,n,r,t);t=o,r=u,n=c,i=h}return{s0:e[l++]^rc(o,t,i,n,r),s1:e[l++]^rc(o,r,t,i,n),s2:e[l++]^rc(o,n,r,t,i),s3:e[l++]^rc(o,i,n,r,t)}}function rd(e,t){if(!t)return new Uint8Array(e);if(tH(t),t.length<e)throw Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function rp(e,t,r,n,i){tH(r,16),tH(n),i=rd(n.length,i);let o=tj(r),s=tV(r),a=tj(n),l=tj(i),u=12*!t,c=n.length,h=s.getUint32(u,t),{s0:f,s1:d,s2:p,s3:g}=rh(e,o[0],o[1],o[2],o[3]);for(let r=0;r+4<=a.length;r+=4)l[r+0]=a[r+0]^f,l[r+1]=a[r+1]^d,l[r+2]=a[r+2]^p,l[r+3]=a[r+3]^g,h=h+1>>>0,s.setUint32(u,h,t),{s0:f,s1:d,s2:p,s3:g}=rh(e,o[0],o[1],o[2],o[3]);let y=16*Math.floor(a.length/4);if(y<c){let e=tM(new Uint32Array([f,d,p,g]));for(let t=y,r=0;t<c;t++,r++)i[t]=n[t]^e[r]}return i}function rg(e){if(tH(e),e.length%16!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}function ry(e,t,r){let n=e.length,i=n%16;if(!t&&0!==i)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");let o=tj(e);if(t){let e=16-i;e||(e=16),n+=e}let s=rd(n,r);return{b:o,o:tj(s),out:s}}function rb(e,t){if(!t)return e;let r=e.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");let n=e[r-1];if(n<=0||n>16)throw Error(`aes/pcks5: wrong padding byte: ${n}`);let i=e.subarray(0,-n);for(let t=0;t<n;t++)if(e[r-t-1]!==n)throw Error("aes/pcks5: wrong padding");return i}function rm(e){let t=new Uint8Array(16),r=tj(t);t.set(e);let n=16-e.length;for(let e=16-n;e<16;e++)t[e]=n;return r}tG({blockSize:16,nonceLength:16},function(e,t){function r(r,n){let i=ra(e),o=t.slice(),s=function(e,t,r,n){tH(t,16),tH(r);let i=r.length;n=rd(i,n);let o=tj(t),{s0:s,s1:a,s2:l,s3:u}=rh(e,o[0],o[1],o[2],o[3]),c=tj(r),h=tj(n);for(let r=0;r+4<=c.length;r+=4){h[r+0]=c[r+0]^s,h[r+1]=c[r+1]^a,h[r+2]=c[r+2]^l,h[r+3]=c[r+3]^u;let n=1;for(let e=t.length-1;e>=0;e--)n=n+(255&t[e])|0,t[e]=255&n,n>>>=8;({s0:s,s1:a,s2:l,s3:u}=rh(e,o[0],o[1],o[2],o[3]))}let f=16*Math.floor(c.length/4);if(f<i){let e=tM(new Uint32Array([s,a,l,u]));for(let t=f,o=0;t<i;t++,o++)n[t]=r[t]^e[o]}return n}(i,o,r,n);return i.fill(0),o.fill(0),s}return tH(e),tH(t,16),{encrypt:(e,t)=>r(e,t),decrypt:(e,t)=>r(e,t)}}),tG({blockSize:16},function(e,t={}){tH(e);let r=!t.disablePadding;return{encrypt:(t,n)=>{tH(t);let{b:i,o,out:s}=ry(t,r,n),a=ra(e),l=0;for(;l+4<=i.length;){let{s0:e,s1:t,s2:r,s3:n}=rh(a,i[l+0],i[l+1],i[l+2],i[l+3]);o[l++]=e,o[l++]=t,o[l++]=r,o[l++]=n}if(r){let e=rm(t.subarray(4*l)),{s0:r,s1:n,s2:i,s3:s}=rh(a,e[0],e[1],e[2],e[3]);o[l++]=r,o[l++]=n,o[l++]=i,o[l++]=s}return a.fill(0),s},decrypt:(t,n)=>{rg(t);let i=rl(e),o=rd(t.length,n),s=tj(t),a=tj(o);for(let e=0;e+4<=s.length;){let{s0:t,s1:r,s2:n,s3:o}=rf(i,s[e+0],s[e+1],s[e+2],s[e+3]);a[e++]=t,a[e++]=r,a[e++]=n,a[e++]=o}return i.fill(0),rb(o,r)}}});let rw=tG({blockSize:16,nonceLength:16},function(e,t,r={}){tH(e),tH(t,16);let n=!r.disablePadding;return{encrypt:(r,i)=>{let o=ra(e),{b:s,o:a,out:l}=ry(r,n,i),u=tj(t),c=u[0],h=u[1],f=u[2],d=u[3],p=0;for(;p+4<=s.length;)c^=s[p+0],h^=s[p+1],f^=s[p+2],d^=s[p+3],({s0:c,s1:h,s2:f,s3:d}=rh(o,c,h,f,d)),a[p++]=c,a[p++]=h,a[p++]=f,a[p++]=d;if(n){let e=rm(r.subarray(4*p));c^=e[0],h^=e[1],f^=e[2],d^=e[3],({s0:c,s1:h,s2:f,s3:d}=rh(o,c,h,f,d)),a[p++]=c,a[p++]=h,a[p++]=f,a[p++]=d}return o.fill(0),l},decrypt:(r,i)=>{rg(r);let o=rl(e),s=tj(t),a=rd(r.length,i),l=tj(r),u=tj(a),c=s[0],h=s[1],f=s[2],d=s[3];for(let e=0;e+4<=l.length;){let t=c,r=h,n=f,i=d;c=l[e+0],h=l[e+1];let{s0:s,s1:a,s2:p,s3:g}=rf(o,c,h,f=l[e+2],d=l[e+3]);u[e++]=s^t,u[e++]=a^r,u[e++]=p^n,u[e++]=g^i}return o.fill(0),rb(a,n)}}});function rE(e,t,r,n,i){let o=e.create(r,n.length+(i?.length||0));i&&o.update(i),o.update(n);let s=new Uint8Array(16),a=tV(s);return i&&tJ(a,0,BigInt(8*i.length),t),tJ(a,8,BigInt(8*n.length),t),o.update(s),o.digest()}tG({blockSize:16,nonceLength:16},function(e,t){function r(r,n,i){let o=ra(e),s=r.length;i=rd(s,i);let a=tj(r),l=tj(i),u=n?l:a,c=tj(t),h=c[0],f=c[1],d=c[2],p=c[3];for(let e=0;e+4<=a.length;){let{s0:t,s1:r,s2:n,s3:i}=rh(o,h,f,d,p);l[e+0]=a[e+0]^t,l[e+1]=a[e+1]^r,l[e+2]=a[e+2]^n,l[e+3]=a[e+3]^i,h=u[e++],f=u[e++],d=u[e++],p=u[e++]}let g=16*Math.floor(a.length/4);if(g<s){({s0:h,s1:f,s2:d,s3:p}=rh(o,h,f,d,p));let e=tM(new Uint32Array([h,f,d,p]));for(let t=g,n=0;t<s;t++,n++)i[t]=r[t]^e[n];e.fill(0)}return o.fill(0),i}return tH(e),tH(t,16),{encrypt:(e,t)=>r(e,!0,t),decrypt:(e,t)=>r(e,!1,t)}}),tG({blockSize:16,nonceLength:12,tagLength:16},function(e,t,r){if(tH(t),0===t.length)throw Error("aes/gcm: empty nonce");function n(e,t,n){let i=rE(t8,!1,e,n,r);for(let e=0;e<t.length;e++)i[e]^=t[e];return i}function i(){let r=ra(e),n=t4.slice(),i=t4.slice();if(rp(r,!1,i,i,n),12===t.length)i.set(t);else{let e=t4.slice();tJ(tV(e),8,BigInt(8*t.length),!1),t8.create(n).update(t).update(e).digestInto(i)}let o=rp(r,!1,i,t4);return{xk:r,authKey:n,counter:i,tagMask:o}}return{encrypt:e=>{tH(e);let{xk:t,authKey:r,counter:o,tagMask:s}=i(),a=new Uint8Array(e.length+16);rp(t,!1,o,e,a);let l=n(r,s,a.subarray(0,a.length-16));return a.set(l,e.length),t.fill(0),a},decrypt:e=>{if(tH(e),e.length<16)throw Error("aes/gcm: ciphertext less than tagLen (16)");let{xk:t,authKey:r,counter:o,tagMask:s}=i(),a=e.subarray(0,-16),l=e.subarray(-16);if(!tK(n(r,s,a),l))throw Error("aes/gcm: invalid ghash tag");let u=rp(t,!1,o,a);return r.fill(0),s.fill(0),t.fill(0),u}}});let rx=(e,t,r)=>n=>{if(!Number.isSafeInteger(n)||t>n||n>r)throw Error(`${e}: invalid value=${n}, must be [${t}..${r}]`)};tG({blockSize:16,nonceLength:12,tagLength:16},function(e,t,r){let n=rx("AAD",0,0x1000000000),i=rx("plaintext",0,0x1000000000),o=rx("nonce",12,12),s=rx("ciphertext",16,0x1000000000+16);function a(){let r=e.length;if(16!==r&&24!==r&&32!==r)throw Error(`key length must be 16, 24 or 32 bytes, got: ${r} bytes`);let n=ra(e),i=new Uint8Array(r),o=new Uint8Array(16),s=tj(t),a=0,l=s[0],u=s[1],c=s[2],h=0;for(let e of[o,i].map(tj)){let t=tj(e);for(let e=0;e<t.length;e+=2){let{s0:r,s1:i}=rh(n,a,l,u,c);t[e+0]=r,t[e+1]=i,a=++h}}return n.fill(0),{authKey:o,encKey:ra(i)}}function l(e,n,i){let o=rE(t6,!0,n,i,r);for(let e=0;e<12;e++)o[e]^=t[e];o[15]&=127;let s=tj(o),a=s[0],l=s[1],u=s[2],c=s[3];return{s0:a,s1:l,s2:u,s3:c}=rh(e,a,l,u,c),s[0]=a,s[1]=l,s[2]=u,s[3]=c,o}function u(e,t,r){let n=t.slice();return n[15]|=128,rp(e,!0,n,r)}return tH(t),o(t.length),r&&(tH(r),n(r.length)),{encrypt:e=>{tH(e),i(e.length);let{encKey:t,authKey:r}=a(),n=l(t,r,e),o=new Uint8Array(e.length+16);return o.set(n,e.length),o.set(u(t,n,e)),t.fill(0),r.fill(0),o},decrypt:e=>{tH(e),s(e.length);let t=e.subarray(-16),{encKey:r,authKey:n}=a(),i=u(r,t,e.subarray(0,-16)),o=l(r,n,i);if(r.fill(0),n.fill(0),!tK(t,o))throw Error("invalid polyval tag");return i}}});let rv=(e,t)=>255&e[t++]|(255&e[t++])<<8;class rA{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,tH(e=tZ(e),32);const t=rv(e,0),r=rv(e,2),n=rv(e,4),i=rv(e,6),o=rv(e,8),s=rv(e,10),a=rv(e,12),l=rv(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|n<<6)&7939,this.r[3]=(n>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|s<<2)&8191,this.r[7]=(s>>>11|a<<5)&8065,this.r[8]=(a>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let t=0;t<8;t++)this.pad[t]=rv(e,16+2*t)}process(e,t,r=!1){let{h:n,r:i}=this,o=i[0],s=i[1],a=i[2],l=i[3],u=i[4],c=i[5],h=i[6],f=i[7],d=i[8],p=i[9],g=rv(e,t+0),y=rv(e,t+2),b=rv(e,t+4),m=rv(e,t+6),w=rv(e,t+8),E=rv(e,t+10),x=rv(e,t+12),v=rv(e,t+14),A=n[0]+(8191&g),S=n[1]+((g>>>13|y<<3)&8191),U=n[2]+((y>>>10|b<<6)&8191),B=n[3]+((b>>>7|m<<9)&8191),I=n[4]+((m>>>4|w<<12)&8191),k=n[5]+(w>>>1&8191),N=n[6]+((w>>>14|E<<2)&8191),T=n[7]+((E>>>11|x<<5)&8191),L=n[8]+((x>>>8|v<<8)&8191),_=n[9]+(v>>>5|2048*!r),O=0,R=0+A*o+5*p*S+5*d*U+5*f*B+5*h*I;O=R>>>13,R&=8191,R+=5*c*k+5*u*N+5*l*T+5*a*L+5*s*_,O+=R>>>13,R&=8191;let $=O+A*s+S*o+5*p*U+5*d*B+5*f*I;O=$>>>13,$&=8191,$+=5*h*k+5*c*N+5*u*T+5*l*L+5*a*_,O+=$>>>13,$&=8191;let P=O+A*a+S*s+U*o+5*p*B+5*d*I;O=P>>>13,P&=8191,P+=5*f*k+5*h*N+5*c*T+5*u*L+5*l*_,O+=P>>>13,P&=8191;let H=O+A*l+S*a+U*s+B*o+5*p*I;O=H>>>13,H&=8191,H+=5*d*k+5*f*N+5*h*T+5*c*L+5*u*_,O+=H>>>13,H&=8191;let C=O+A*u+S*l+U*a+B*s+I*o;O=C>>>13,C&=8191,C+=5*p*k+5*d*N+5*f*T+5*h*L+5*c*_,O+=C>>>13,C&=8191;let q=O+A*c+S*u+U*l+B*a+I*s;O=q>>>13,q&=8191,q+=k*o+5*p*N+5*d*T+5*f*L+5*h*_,O+=q>>>13,q&=8191;let M=O+A*h+S*c+U*u+B*l+I*a;O=M>>>13,M&=8191,M+=k*s+N*o+5*p*T+5*d*L+5*f*_,O+=M>>>13,M&=8191;let j=O+A*f+S*h+U*c+B*u+I*l;O=j>>>13,j&=8191,j+=k*a+N*s+T*o+5*p*L+5*d*_,O+=j>>>13,j&=8191;let V=O+A*d+S*f+U*h+B*c+I*u;O=V>>>13,V&=8191,V+=k*l+N*a+T*s+L*o+5*p*_,O+=V>>>13,V&=8191;let z=O+A*p+S*d+U*f+B*h+I*c;O=z>>>13,z&=8191,z+=k*u+N*l+T*a+L*s+_*o,O+=z>>>13,z&=8191,R=8191&(O=(O=(O<<2)+O|0)+R|0),O>>>=13,$+=O,n[0]=R,n[1]=$,n[2]=P,n[3]=H,n[4]=C,n[5]=q,n[6]=M,n[7]=j,n[8]=V,n[9]=z}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),n=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=n,n=e[t]>>>13,e[t]&=8191;e[0]+=5*n,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,r[0]=e[0]+5,n=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+n,n=r[t]>>>13,r[t]&=8191;r[9]-=8192;let i=(1^n)-1;for(let e=0;e<10;e++)r[e]&=i;i=~i;for(let t=0;t<10;t++)e[t]=e[t]&i|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=65535&o;for(let r=1;r<8;r++)o=(e[r]+t[r]|0)+(o>>>16)|0,e[r]=65535&o}update(e){tC(this);let{buffer:t,blockLen:r}=this,n=(e=tZ(e)).length;for(let i=0;i<n;){let o=Math.min(r-this.pos,n-i);if(o===r){for(;r<=n-i;i+=r)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){tC(this),tq(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:n}=this;if(n){for(t[n++]=1;n<16;n++)t[n]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let t=0;t<8;t++)e[i++]=r[t]>>>0,e[i++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}let rS=(u=e=>new rA(e),(o=(e,t)=>u(t).update(tZ(e)).digest()).outputLen=(s=u(new Uint8Array(32))).outputLen,o.blockLen=s.blockLen,o.create=e=>u(e),o),rU=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),rB=rU("expand 16-byte k"),rI=rU("expand 32-byte k"),rk=tj(rB),rN=tj(rI);function rT(e,t){return e<<t|e>>>32-t}function rL(e){return e.byteOffset%4==0}rN.slice();let r_=0x100000000-1,rO=new Uint32Array;function rR(e,t){let{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:o,rounds:s}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return tR(i),tR(s),t$(o),t$(r),(t,a,l,u,c=0)=>{tH(t),tH(a),tH(l);let h=l.length;if(u||(u=new Uint8Array(h)),tH(u),tR(c),c<0||c>=r_)throw Error("arx: counter overflow");if(u.length<h)throw Error(`arx: output (${u.length}) is shorter than data (${h})`);let f=[],d=t.length,p,g;if(32===d)p=t.slice(),f.push(p),g=rN;else if(16===d&&r)(p=new Uint8Array(32)).set(t),p.set(t,16),g=rk,f.push(p);else throw Error(`arx: invalid 32-byte key, got length=${d}`);rL(a)||(a=a.slice(),f.push(a));let y=tj(p);if(n){if(24!==a.length)throw Error("arx: extended nonce must be 24 bytes");n(g,y,tj(a.subarray(0,16)),y),a=a.subarray(16)}let b=16-i;if(b!==a.length)throw Error(`arx: nonce must be ${b} or 16 bytes`);if(12!==b){let e=new Uint8Array(12);e.set(a,o?0:12-a.length),a=e,f.push(a)}for(!function(e,t,r,n,i,o,s,a){let l=i.length,u=new Uint8Array(64),c=tj(u),h=rL(i)&&rL(o),f=h?tj(i):rO,d=h?tj(o):rO;for(let p=0;p<l;s++){if(e(t,r,n,c,s,a),s>=r_)throw Error("arx: counter overflow");let g=Math.min(64,l-p);if(h&&64===g){let e=p/4;if(p%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)d[r=e+t]=f[r]^c[t];p+=64;continue}for(let e=0,t;e<g;e++)o[t=p+e]=i[t]^u[e];p+=g}}(e,g,y,tj(a),l,u,c,s);f.length>0;)f.pop().fill(0);return u}}function r$(e,t,r,n,i,o=20){let s=e[0],a=e[1],l=e[2],u=e[3],c=t[0],h=t[1],f=t[2],d=t[3],p=t[4],g=t[5],y=t[6],b=t[7],m=r[0],w=r[1],E=r[2],x=s,v=a,A=l,S=u,U=c,B=h,I=f,k=d,N=p,T=g,L=y,_=b,O=i,R=m,$=w,P=E;for(let e=0;e<o;e+=2)N=N+(O=rT(O^(x=x+U|0),16))|0,x=x+(U=rT(U^N,12))|0,N=N+(O=rT(O^x,8))|0,U=rT(U^N,7),T=T+(R=rT(R^(v=v+B|0),16))|0,v=v+(B=rT(B^T,12))|0,T=T+(R=rT(R^v,8))|0,B=rT(B^T,7),L=L+($=rT($^(A=A+I|0),16))|0,A=A+(I=rT(I^L,12))|0,L=L+($=rT($^A,8))|0,I=rT(I^L,7),_=_+(P=rT(P^(S=S+k|0),16))|0,S=S+(k=rT(k^_,12))|0,_=_+(P=rT(P^S,8))|0,k=rT(k^_,7),L=L+(P=rT(P^(x=x+B|0),16))|0,x=x+(B=rT(B^L,12))|0,L=L+(P=rT(P^x,8))|0,B=rT(B^L,7),_=_+(O=rT(O^(v=v+I|0),16))|0,v=v+(I=rT(I^_,12))|0,_=_+(O=rT(O^v,8))|0,I=rT(I^_,7),N=N+(R=rT(R^(A=A+k|0),16))|0,A=A+(k=rT(k^N,12))|0,N=N+(R=rT(R^A,8))|0,k=rT(k^N,7),T=T+($=rT($^(S=S+U|0),16))|0,S=S+(U=rT(U^T,12))|0,T=T+($=rT($^S,8))|0,U=rT(U^T,7);let H=0;n[H++]=s+x|0,n[H++]=a+v|0,n[H++]=l+A|0,n[H++]=u+S|0,n[H++]=c+U|0,n[H++]=h+B|0,n[H++]=f+I|0,n[H++]=d+k|0,n[H++]=p+N|0,n[H++]=g+T|0,n[H++]=y+L|0,n[H++]=b+_|0,n[H++]=i+O|0,n[H++]=m+R|0,n[H++]=w+$|0,n[H++]=E+P|0}let rP=rR(r$,{counterRight:!1,counterLength:4,allowShortKeys:!1}),rH=rR(r$,{counterRight:!1,counterLength:8,extendNonceFn:function(e,t,r,n){let i=e[0],o=e[1],s=e[2],a=e[3],l=t[0],u=t[1],c=t[2],h=t[3],f=t[4],d=t[5],p=t[6],g=t[7],y=r[0],b=r[1],m=r[2],w=r[3];for(let e=0;e<20;e+=2)f=f+(y=rT(y^(i=i+l|0),16))|0,i=i+(l=rT(l^f,12))|0,f=f+(y=rT(y^i,8))|0,l=rT(l^f,7),d=d+(b=rT(b^(o=o+u|0),16))|0,o=o+(u=rT(u^d,12))|0,d=d+(b=rT(b^o,8))|0,u=rT(u^d,7),p=p+(m=rT(m^(s=s+c|0),16))|0,s=s+(c=rT(c^p,12))|0,p=p+(m=rT(m^s,8))|0,c=rT(c^p,7),g=g+(w=rT(w^(a=a+h|0),16))|0,a=a+(h=rT(h^g,12))|0,g=g+(w=rT(w^a,8))|0,h=rT(h^g,7),p=p+(w=rT(w^(i=i+u|0),16))|0,i=i+(u=rT(u^p,12))|0,p=p+(w=rT(w^i,8))|0,u=rT(u^p,7),g=g+(y=rT(y^(o=o+c|0),16))|0,o=o+(c=rT(c^g,12))|0,g=g+(y=rT(y^o,8))|0,c=rT(c^g,7),f=f+(b=rT(b^(s=s+h|0),16))|0,s=s+(h=rT(h^f,12))|0,f=f+(b=rT(b^s,8))|0,h=rT(h^f,7),d=d+(m=rT(m^(a=a+l|0),16))|0,a=a+(l=rT(l^d,12))|0,d=d+(m=rT(m^a,8))|0,l=rT(l^d,7);let E=0;n[E++]=i,n[E++]=o,n[E++]=s,n[E++]=a,n[E++]=y,n[E++]=b,n[E++]=m,n[E++]=w},allowShortKeys:!1}),rC=new Uint8Array(16),rq=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(rC.subarray(r))},rM=new Uint8Array(32);function rj(e,t,r,n,i){let o=e(t,r,rM),s=rS.create(o);i&&rq(s,i),rq(s,n);let a=new Uint8Array(16),l=tV(a);tJ(l,0,BigInt(i?i.length:0),!0),tJ(l,8,BigInt(n.length),!0),s.update(a);let u=s.digest();return o.fill(0),u}let rV=e=>(t,r,n)=>(tH(t,32),tH(r),{encrypt:(i,o)=>{let s=i.length,a=s+16;o?tH(o,a):o=new Uint8Array(a),e(t,r,i,o,1);let l=rj(e,t,r,o.subarray(0,-16),n);return o.set(l,s),o},decrypt:(i,o)=>{let s=i.length,a=s-16;if(s<16)throw Error("encrypted data must be at least 16 bytes");o?tH(o,a):o=new Uint8Array(a);let l=i.subarray(0,-16);if(!tK(i.subarray(-16),rj(e,t,r,l,n)))throw Error("invalid tag");return e(t,r,l,o,1),o}});rV(rP),rV(rH);class rz extends e5{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,tr(e);const r=e6(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return tn(this),this.iHash.update(e),this}digestInto(e){tn(this),tt(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let rD=(e,t,r)=>new rz(e,t).update(r).digest();rD.create=(e,t)=>new rz(e,t);let rF=new Uint8Array([0]),rW=new Uint8Array;var rZ=Object.defineProperty,rK=(e,t)=>{for(var r in t)rZ(e,r,{get:t[r],enumerable:!0})},rG=Symbol("verified");function rJ(e){if(!(e instanceof Object)||"number"!=typeof e.kind||"string"!=typeof e.content||"number"!=typeof e.created_at||"string"!=typeof e.pubkey||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let r=e.tags[t];if(!Array.isArray(r))return!1;for(let e=0;e<r.length;e++)if("string"!=typeof r[e])return!1}return!0}rK({},{Queue:()=>r8,QueueNode:()=>r3,binarySearch:()=>r2,bytesToHex:()=>e3,hexToBytes:()=>e8,insertEventIntoAscendingList:()=>r1,insertEventIntoDescendingList:()=>r0,normalizeURL:()=>rQ,utf8Decoder:()=>rX,utf8Encoder:()=>rY});var rX=new TextDecoder("utf-8"),rY=new TextEncoder;function rQ(e){try{-1===e.indexOf("://")&&(e="wss://"+e);let t=new URL(e);return"http:"===t.protocol?t.protocol="ws:":"https:"===t.protocol&&(t.protocol="wss:"),t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),("80"===t.port&&"ws:"===t.protocol||"443"===t.port&&"wss:"===t.protocol)&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}catch(t){throw Error(`Invalid URL: ${e}`)}}function r0(e,t){let[r,n]=r2(e,e=>t.id===e.id?0:t.created_at===e.created_at?-1:e.created_at-t.created_at);return n||e.splice(r,0,t),e}function r1(e,t){let[r,n]=r2(e,e=>t.id===e.id?0:t.created_at===e.created_at?-1:t.created_at-e.created_at);return n||e.splice(r,0,t),e}function r2(e,t){let r=0,n=e.length-1;for(;r<=n;){let i=Math.floor((r+n)/2),o=t(e[i]);if(0===o)return[i,!0];o<0?n=i-1:r=i+1}return[r,!1]}var r3=class{value;next=null;prev=null;constructor(e){this.value=e}},r8=class{first;last;constructor(){this.first=null,this.last=null}enqueue(e){let t=new r3(e);return this.last?this.last===this.first?(this.last=t,this.last.prev=this.first,this.first.next=t):(t.prev=this.last,this.last.next=t,this.last=t):(this.first=t,this.last=t),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){let e=this.first;return this.first=null,this.last=null,e.value}let e=this.first;return this.first=e.next,this.first&&(this.first.prev=null),e.value}};function r6(e){return e3(td(rY.encode(function(e){if(!rJ(e))throw Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}(e))))}var r4=new class{generateSecretKey(){return eJ.utils.randomPrivateKey()}getPublicKey(e){return e3(eJ.getPublicKey(e))}finalizeEvent(e,t){return e.pubkey=e3(eJ.getPublicKey(t)),e.id=r6(e),e.sig=e3(eJ.sign(r6(e),t)),e[rG]=!0,e}verifyEvent(e){if("boolean"==typeof e[rG])return e[rG];let t=r6(e);if(t!==e.id)return e[rG]=!1,!1;try{let r=eJ.verify(e.sig,t,e.pubkey);return e[rG]=r,r}catch(t){return e[rG]=!1,!1}}},r5=r4.generateSecretKey,r9=r4.getPublicKey,r7=r4.finalizeEvent,ne=r4.verifyEvent;function nt(e){return e<1e4&&0!==e&&3!==e}function nr(e){return 0===e||3===e||1e4<=e&&e<2e4}function nn(e){return 2e4<=e&&e<3e4}function ni(e){return 3e4<=e&&e<4e4}function no(e){return nt(e)?"regular":nr(e)?"replaceable":nn(e)?"ephemeral":ni(e)?"parameterized":"unknown"}function ns(e,t){let r=t instanceof Array?t:[t];return rJ(e)&&r.includes(e.kind)||!1}rK({},{Application:()=>iA,BadgeAward:()=>ng,BadgeDefinition:()=>iy,BlockedRelaysList:()=>n3,BlossomServerList:()=>ie,BookmarkList:()=>n0,Bookmarksets:()=>id,Calendar:()=>iT,CalendarEventRSVP:()=>iL,ChannelCreation:()=>nU,ChannelHideMessage:()=>nk,ChannelMessage:()=>nI,ChannelMetadata:()=>nB,ChannelMuteUser:()=>nN,ChatMessage:()=>ny,ClassifiedListing:()=>iB,ClientAuth:()=>ii,Comment:()=>nR,CommunitiesList:()=>n1,CommunityDefinition:()=>i$,CommunityPostApproval:()=>nV,Contacts:()=>nc,CreateOrUpdateProduct:()=>iw,CreateOrUpdateStall:()=>im,Curationsets:()=>ip,Date:()=>ik,DirectMessageRelaysList:()=>n9,DraftClassifiedListing:()=>iI,DraftLong:()=>ix,Emojisets:()=>iv,EncryptedDirectMessage:()=>nh,EventDeletion:()=>nf,FavoriteRelays:()=>n6,FileMessage:()=>nE,FileMetadata:()=>nO,FileServerPreference:()=>n7,Followsets:()=>iu,ForumThread:()=>nb,GenericRepost:()=>nx,Genericlists:()=>ic,GiftWrap:()=>nL,GroupMetadata:()=>iP,HTTPAuth:()=>il,Handlerinformation:()=>iR,Handlerrecommendation:()=>iO,Highlights:()=>nG,InterestsList:()=>n4,Interestsets:()=>ib,JobFeedback:()=>nF,JobRequest:()=>nz,JobResult:()=>nD,Label:()=>nj,LightningPubRPC:()=>ir,LiveChatMessage:()=>n$,LiveEvent:()=>iS,LongFormArticle:()=>iE,Metadata:()=>na,Mutelist:()=>nX,NWCWalletInfo:()=>it,NWCWalletRequest:()=>io,NWCWalletResponse:()=>is,NormalVideo:()=>nA,NostrConnect:()=>ia,OpenTimestamps:()=>nT,Photo:()=>nv,Pinlist:()=>nY,Poll:()=>n_,PollResponse:()=>nJ,PrivateDirectMessage:()=>nw,ProblemTracker:()=>nC,ProfileBadges:()=>ig,PublicChatsList:()=>n2,Reaction:()=>np,RecommendRelay:()=>nu,RelayList:()=>nQ,RelayReview:()=>i_,Relaysets:()=>ih,Report:()=>nq,Reporting:()=>nM,Repost:()=>nd,Seal:()=>nm,SearchRelaysList:()=>n8,ShortTextNote:()=>nl,ShortVideo:()=>nS,Time:()=>iN,UserEmojiList:()=>n5,UserStatuses:()=>iU,Voice:()=>nP,VoiceComment:()=>nH,Zap:()=>nK,ZapGoal:()=>nW,ZapRequest:()=>nZ,classifyKind:()=>no,isAddressableKind:()=>ni,isEphemeralKind:()=>nn,isKind:()=>ns,isRegularKind:()=>nt,isReplaceableKind:()=>nr});var na=0,nl=1,nu=2,nc=3,nh=4,nf=5,nd=6,np=7,ng=8,ny=9,nb=11,nm=13,nw=14,nE=15,nx=16,nv=20,nA=21,nS=22,nU=40,nB=41,nI=42,nk=43,nN=44,nT=1040,nL=1059,n_=1068,nO=1063,nR=1111,n$=1311,nP=1222,nH=1244,nC=1971,nq=1984,nM=1984,nj=1985,nV=4550,nz=5999,nD=6999,nF=7e3,nW=9041,nZ=9734,nK=9735,nG=9802,nJ=1018,nX=1e4,nY=10001,nQ=10002,n0=10003,n1=10004,n2=10005,n3=10006,n8=10007,n6=10012,n4=10015,n5=10030,n9=10050,n7=10096,ie=10063,it=13194,ir=21e3,ii=22242,io=23194,is=23195,ia=24133,il=27235,iu=3e4,ic=30001,ih=30002,id=30003,ip=30004,ig=30008,iy=30009,ib=30015,im=30017,iw=30018,iE=30023,ix=30024,iv=30030,iA=30078,iS=30311,iU=30315,iB=30402,iI=30403,ik=31922,iN=31923,iT=31924,iL=31925,i_=31987,iO=31989,iR=31990,i$=34550,iP=39e3;function iH(e,t){let r=t.length+3,n=e.indexOf(`"${t}":`)+r,i=e.slice(n).indexOf('"')+n+1;return e.slice(i,i+64)}function iC(e,t){let r=t.length,n=e.indexOf(`"${t}":`)+r+3,i=e.slice(n),o=Math.min(i.indexOf(","),i.indexOf("}"));return parseInt(i.slice(0,o),10)}function iq(e){let t=e.slice(0,22).indexOf('"EVENT"');if(-1===t)return null;let r=e.slice(t+7+1).indexOf('"');if(-1===r)return null;let n=t+7+1+r,i=e.slice(n+1,80).indexOf('"');return -1===i?null:e.slice(n+1,n+1+i)}function iM(e,t){return t===iH(e,"id")}function ij(e,t){return t===iH(e,"pubkey")}function iV(e,t){return t===iC(e,"kind")}function iz(e,t){return{kind:ii,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}async function iD(){return new Promise((e,t)=>{try{if("undefined"!=typeof MessageChannel){let t=new MessageChannel,r=()=>{t.port1.removeEventListener("message",r),e()};t.port1.addEventListener("message",r),t.port2.postMessage(0),t.port1.start()}else"undefined"!=typeof setImmediate?setImmediate(e):"undefined"!=typeof setTimeout?setTimeout(e,0):e()}catch(e){console.error("during yield: ",e),t(e)}})}rK({},{getHex64:()=>iH,getInt:()=>iC,getSubscriptionId:()=>iq,matchEventId:()=>iM,matchEventKind:()=>iV,matchEventPubkey:()=>ij}),rK({},{makeAuthEvent:()=>iz});var iF=e=>(e[rG]=!0,!0),iW=class extends Error{constructor(e,t){super(`Tried to send message '${e} on a closed connection to ${t}.`),this.name="SendingOnClosedConnection"}},iZ=class{url;_connected=!1;onclose=null;onnotice=e=>console.debug(`NOTICE from ${this.url}: ${e}`);onauth;baseEoseTimeout=4400;connectionTimeout=4400;publishTimeout=4400;pingFrequency=29e3;pingTimeout=2e4;resubscribeBackoff=[1e4,1e4,1e4,2e4,2e4,3e4,6e4];openSubs=new Map;enablePing;enableReconnect;connectionTimeoutHandle;reconnectTimeoutHandle;pingIntervalHandle;reconnectAttempts=0;closedIntentionally=!1;connectionPromise;openCountRequests=new Map;openEventPublishes=new Map;ws;incomingMessageQueue=new r8;queueRunning=!1;challenge;authPromise;serial=0;verifyEvent;_WebSocket;constructor(e,t){this.url=rQ(e),this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation||WebSocket,this.enablePing=t.enablePing,this.enableReconnect=t.enableReconnect||!1}static async connect(e,t){let r=new iZ(e,t);return await r.connect(),r}closeAllSubscriptions(e){for(let[t,r]of this.openSubs)r.close(e);for(let[t,r]of(this.openSubs.clear(),this.openEventPublishes))r.reject(Error(e));for(let[t,r]of(this.openEventPublishes.clear(),this.openCountRequests))r.reject(Error(e));this.openCountRequests.clear()}get connected(){return this._connected}async reconnect(){let e=this.resubscribeBackoff[Math.min(this.reconnectAttempts,this.resubscribeBackoff.length-1)];this.reconnectAttempts++,this.reconnectTimeoutHandle=setTimeout(async()=>{try{await this.connect()}catch(e){}},e)}handleHardClose(e){this.pingIntervalHandle&&(clearInterval(this.pingIntervalHandle),this.pingIntervalHandle=void 0),this._connected=!1,this.connectionPromise=void 0;let t=this.closedIntentionally;this.closedIntentionally=!1,this.onclose?.(),this.enableReconnect&&!t?this.reconnect():this.closeAllSubscriptions(e)}async connect(){return this.connectionPromise||(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((e,t)=>{this.connectionTimeoutHandle=setTimeout(()=>{t("connection timed out"),this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(e){clearTimeout(this.connectionTimeoutHandle),t(e);return}this.ws.onopen=()=>{this.reconnectTimeoutHandle&&(clearTimeout(this.reconnectTimeoutHandle),this.reconnectTimeoutHandle=void 0),clearTimeout(this.connectionTimeoutHandle),this._connected=!0;let t=this.reconnectAttempts>0;for(let e of(this.reconnectAttempts=0,this.openSubs.values())){if(e.eosed=!1,t)for(let t=0;t<e.filters.length;t++)e.lastEmitted&&(e.filters[t].since=e.lastEmitted+1);e.fire()}this.enablePing&&(this.pingIntervalHandle=setInterval(()=>this.pingpong(),this.pingFrequency)),e()},this.ws.onerror=e=>{clearTimeout(this.connectionTimeoutHandle),t(e.message||"websocket error"),this.handleHardClose("relay connection errored")},this.ws.onclose=e=>{clearTimeout(this.connectionTimeoutHandle),t(e.message||"websocket closed"),this.handleHardClose("relay connection closed")},this.ws.onmessage=this._onmessage.bind(this)})),this.connectionPromise}waitForPingPong(){return new Promise(e=>{this.ws.once("pong",()=>e(!0)),this.ws.ping()})}waitForDummyReq(){return new Promise((e,t)=>{if(!this.connectionPromise)return t(Error(`no connection to ${this.url}, can't ping`));try{let t=this.subscribe([{ids:["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"],limit:0}],{oneose:()=>{e(!0),t.close()},onclose(){e(!0)},eoseTimeout:this.pingTimeout+1e3})}catch(e){t(e)}})}async pingpong(){this.ws?.readyState===1&&(await Promise.any([this.ws&&this.ws.ping&&this.ws.once?this.waitForPingPong():this.waitForDummyReq(),new Promise(e=>setTimeout(()=>e(!1),this.pingTimeout))])||this.ws?.readyState!==this._WebSocket.OPEN||this.ws?.close())}async runQueue(){for(this.queueRunning=!0;!1!==this.handleNext();)await iD();this.queueRunning=!1}handleNext(){let e=this.incomingMessageQueue.dequeue();if(!e)return!1;let t=iq(e);if(t){let r=this.openSubs.get(t);if(!r)return;let n=iH(e,"id"),i=r.alreadyHaveEvent?.(n);if(r.receivedEvent?.(this,n),i)return}try{let t=JSON.parse(e);switch(t[0]){case"EVENT":{let e=this.openSubs.get(t[1]),r=t[2];this.verifyEvent(r)&&function(e,t){for(let r=0;r<e.length;r++)if(function(e,t){if(e.ids&&-1===e.ids.indexOf(t.id)||e.kinds&&-1===e.kinds.indexOf(t.kind)||e.authors&&-1===e.authors.indexOf(t.pubkey))return!1;for(let r in e)if("#"===r[0]){let n=r.slice(1),i=e[`#${n}`];if(i&&!t.tags.find(([e,t])=>e===r.slice(1)&&-1!==i.indexOf(t)))return!1}return(!e.since||!(t.created_at<e.since))&&(!e.until||!(t.created_at>e.until))}(e[r],t))return!0;return!1}(e.filters,r)&&e.onevent(r),(!e.lastEmitted||e.lastEmitted<r.created_at)&&(e.lastEmitted=r.created_at);return}case"COUNT":{let e=t[1],r=t[2],n=this.openCountRequests.get(e);n&&(n.resolve(r.count),this.openCountRequests.delete(e));return}case"EOSE":{let e=this.openSubs.get(t[1]);if(!e)return;e.receivedEose();return}case"OK":{let e=t[1],r=t[2],n=t[3],i=this.openEventPublishes.get(e);i&&(clearTimeout(i.timeout),r?i.resolve(n):i.reject(Error(n)),this.openEventPublishes.delete(e));return}case"CLOSED":{let e=t[1],r=this.openSubs.get(e);if(!r)return;r.closed=!0,r.close(t[2]);return}case"NOTICE":return void this.onnotice(t[1]);case"AUTH":this.challenge=t[1],this.onauth&&this.auth(this.onauth);return;default:{let e=this.openSubs.get(t[1]);e?.oncustom?.(t);return}}}catch(e){return}}async send(e){if(!this.connectionPromise)throw new iW(e,this.url);this.connectionPromise.then(()=>{this.ws?.send(e)})}async auth(e){let t=this.challenge;if(!t)throw Error("can't perform auth, no challenge was received");return this.authPromise||(this.authPromise=new Promise(async(r,n)=>{try{let i=await e(iz(this.url,t)),o=setTimeout(()=>{let e=this.openEventPublishes.get(i.id);e&&(e.reject(Error("auth timed out")),this.openEventPublishes.delete(i.id))},this.publishTimeout);this.openEventPublishes.set(i.id,{resolve:r,reject:n,timeout:o}),this.send('["AUTH",'+JSON.stringify(i)+"]")}catch(e){console.warn("subscribe auth function failed:",e)}})),this.authPromise}async publish(e){let t=new Promise((t,r)=>{let n=setTimeout(()=>{let t=this.openEventPublishes.get(e.id);t&&(t.reject(Error("publish timed out")),this.openEventPublishes.delete(e.id))},this.publishTimeout);this.openEventPublishes.set(e.id,{resolve:t,reject:r,timeout:n})});return this.send('["EVENT",'+JSON.stringify(e)+"]"),t}async count(e,t){this.serial++;let r=t?.id||"count:"+this.serial,n=new Promise((e,t)=>{this.openCountRequests.set(r,{resolve:e,reject:t})});return this.send('["COUNT","'+r+'",'+JSON.stringify(e).substring(1)),n}subscribe(e,t){let r=this.prepareSubscription(e,t);return r.fire(),r}prepareSubscription(e,t){this.serial++;let r=t.id||(t.label?t.label+":":"sub:")+this.serial,n=new iK(this,r,e,t);return this.openSubs.set(r,n),n}close(){this.closedIntentionally=!0,this.reconnectTimeoutHandle&&(clearTimeout(this.reconnectTimeoutHandle),this.reconnectTimeoutHandle=void 0),this.pingIntervalHandle&&(clearInterval(this.pingIntervalHandle),this.pingIntervalHandle=void 0),this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,this.onclose?.(),this.ws?.readyState===this._WebSocket.OPEN&&this.ws?.close()}_onmessage(e){this.incomingMessageQueue.enqueue(e.data),this.queueRunning||this.runQueue()}},iK=class{relay;id;lastEmitted;closed=!1;eosed=!1;filters;alreadyHaveEvent;receivedEvent;onevent;oneose;onclose;oncustom;eoseTimeout;eoseTimeoutHandle;constructor(e,t,r,n){if(0===r.length)throw Error("subscription can't be created with zero filters");this.relay=e,this.filters=r,this.id=t,this.alreadyHaveEvent=n.alreadyHaveEvent,this.receivedEvent=n.receivedEvent,this.eoseTimeout=n.eoseTimeout||e.baseEoseTimeout,this.oneose=n.oneose,this.onclose=n.onclose,this.onevent=n.onevent||(e=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,e)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,this.oneose?.())}close(e="closed by caller"){if(!this.closed&&this.relay.connected){try{this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]")}catch(e){if(e instanceof iW);else throw e}this.closed=!0}this.relay.openSubs.delete(this.id),this.onclose?.(e)}};try{WebSocket}catch{}var iG=class{relays=new Map;seenOn=new Map;trackRelays=!1;verifyEvent;enablePing;enableReconnect;automaticallyAuth;trustedRelayURLs=new Set;_WebSocket;constructor(e){this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation,this.enablePing=e.enablePing,this.enableReconnect=e.enableReconnect||!1,this.automaticallyAuth=e.automaticallyAuth}async ensureRelay(e,t){e=rQ(e);let r=this.relays.get(e);if(r||((r=new iZ(e,{verifyEvent:this.trustedRelayURLs.has(e)?iF:this.verifyEvent,websocketImplementation:this._WebSocket,enablePing:this.enablePing,enableReconnect:this.enableReconnect})).onclose=()=>{r&&!r.enableReconnect&&this.relays.delete(e)},t?.connectionTimeout&&(r.connectionTimeout=t.connectionTimeout),this.relays.set(e,r)),this.automaticallyAuth){let t=this.automaticallyAuth(e);t&&(r.onauth=t)}return await r.connect(),r}close(e){e.map(rQ).forEach(e=>{this.relays.get(e)?.close(),this.relays.delete(e)})}subscribe(e,t,r){let n=[];for(let r=0;r<e.length;r++){let i=rQ(e[r]);n.find(e=>e.url===i)||n.push({url:i,filter:t})}return this.subscribeMap(n,r)}subscribeMany(e,t,r){let n=[],i=[];for(let r=0;r<e.length;r++){let o=rQ(e[r]);-1===i.indexOf(o)&&(i.push(o),n.push({url:o,filter:t}))}return this.subscribeMap(n,r)}subscribeMap(e,t){let r=new Map;for(let t of e){let{url:e,filter:n}=t;r.has(e)||r.set(e,[]),r.get(e).push(n)}let n=Array.from(r.entries()).map(([e,t])=>({url:e,filters:t}));this.trackRelays&&(t.receivedEvent=(e,t)=>{let r=this.seenOn.get(t);r||(r=new Set,this.seenOn.set(t,r)),r.add(e)});let i=new Set,o=[],s=[],a=e=>{s[e]||(s[e]=!0,s.filter(e=>e).length===n.length&&(t.oneose?.(),a=()=>{}))},l=[],u=(e,r)=>{l[e]||(a(e),l[e]=r,l.filter(e=>e).length===n.length&&(t.onclose?.(l),u=()=>{}))},c=e=>{if(t.alreadyHaveEvent?.(e))return!0;let r=i.has(e);return i.add(e),r},h=Promise.all(n.map(async({url:e,filters:r},n)=>{let i;try{i=await this.ensureRelay(e,{connectionTimeout:t.maxWait?Math.max(.8*t.maxWait,t.maxWait-1e3):void 0})}catch(e){u(n,e?.message||String(e));return}let s=i.subscribe(r,{...t,oneose:()=>a(n),onclose:e=>{e.startsWith("auth-required: ")&&t.onauth?i.auth(t.onauth).then(()=>{i.subscribe(r,{...t,oneose:()=>a(n),onclose:e=>{u(n,e)},alreadyHaveEvent:c,eoseTimeout:t.maxWait})}).catch(e=>{u(n,`auth was required and attempted, but failed with: ${e}`)}):u(n,e)},alreadyHaveEvent:c,eoseTimeout:t.maxWait});o.push(s)}));return{async close(e){await h,o.forEach(t=>{t.close(e)})}}}subscribeEose(e,t,r){let n=this.subscribe(e,t,{...r,oneose(){n.close("closed automatically on eose")}});return n}subscribeManyEose(e,t,r){let n=this.subscribeMany(e,t,{...r,oneose(){n.close("closed automatically on eose")}});return n}async querySync(e,t,r){return new Promise(async n=>{let i=[];this.subscribeEose(e,t,{...r,onevent(e){i.push(e)},onclose(e){n(i)}})})}async get(e,t,r){t.limit=1;let n=await this.querySync(e,t,r);return n.sort((e,t)=>t.created_at-e.created_at),n[0]||null}publish(e,t,r){return e.map(rQ).map(async(e,n,i)=>{if(i.indexOf(e)!==n)return Promise.reject("duplicate url");let o=await this.ensureRelay(e);return o.publish(t).catch(async e=>{if(e instanceof Error&&e.message.startsWith("auth-required: ")&&r?.onauth)return await o.auth(r.onauth),o.publish(t);throw e}).then(e=>{if(this.trackRelays){let e=this.seenOn.get(t.id);e||(e=new Set,this.seenOn.set(t.id,e)),e.add(o)}return e})})}listConnectionStatus(){let e=new Map;return this.relays.forEach((t,r)=>e.set(r,t.connected)),e}destroy(){this.relays.forEach(e=>e.close()),this.relays=new Map}};try{c=WebSocket}catch{}var iJ=class extends iG{constructor(e){super({verifyEvent:ne,websocketImplementation:c,...e})}};rK({},{BECH32_REGEX:()=>iQ,Bech32MaxSize:()=>iY,NostrTypeGuard:()=>iX,decode:()=>i1,decodeNostrURI:()=>i0,encodeBytes:()=>i5,naddrEncode:()=>oe,neventEncode:()=>i7,noteEncode:()=>i6,nprofileEncode:()=>i9,npubEncode:()=>i8,nsecEncode:()=>i3});var iX={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},iY=5e3,iQ=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function i0(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),i1(e)}catch(e){return{type:"invalid",data:null}}}function i1(e){let{prefix:t,words:r}=tO.decode(e,iY),n=new Uint8Array(tO.fromWords(r));switch(t){case"nprofile":{let e=i2(n);if(!e[0]?.[0])throw Error("missing TLV 0 for nprofile");if(32!==e[0][0].length)throw Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:e3(e[0][0]),relays:e[1]?e[1].map(e=>rX.decode(e)):[]}}}case"nevent":{let e=i2(n);if(!e[0]?.[0])throw Error("missing TLV 0 for nevent");if(32!==e[0][0].length)throw Error("TLV 0 should be 32 bytes");if(e[2]&&32!==e[2][0].length)throw Error("TLV 2 should be 32 bytes");if(e[3]&&4!==e[3][0].length)throw Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:e3(e[0][0]),relays:e[1]?e[1].map(e=>rX.decode(e)):[],author:e[2]?.[0]?e3(e[2][0]):void 0,kind:e[3]?.[0]?parseInt(e3(e[3][0]),16):void 0}}}case"naddr":{let e=i2(n);if(!e[0]?.[0])throw Error("missing TLV 0 for naddr");if(!e[2]?.[0])throw Error("missing TLV 2 for naddr");if(32!==e[2][0].length)throw Error("TLV 2 should be 32 bytes");if(!e[3]?.[0])throw Error("missing TLV 3 for naddr");if(4!==e[3][0].length)throw Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:rX.decode(e[0][0]),pubkey:e3(e[2][0]),kind:parseInt(e3(e[3][0]),16),relays:e[1]?e[1].map(e=>rX.decode(e)):[]}}}case"nsec":return{type:t,data:n};case"npub":case"note":return{type:t,data:e3(n)};default:throw Error(`unknown prefix ${t}`)}}function i2(e){let t={},r=e;for(;r.length>0;){let e=r[0],n=r[1],i=r.slice(2,2+n);if(r=r.slice(2+n),i.length<n)throw Error(`not enough data to read on TLV ${e}`);t[e]=t[e]||[],t[e].push(i)}return t}function i3(e){return i4("nsec",e)}function i8(e){return i4("npub",e8(e))}function i6(e){return i4("note",e8(e))}function i4(e,t){let r=tO.toWords(t);return tO.encode(e,r,iY)}function i5(e,t){return i4(e,t)}function i9(e){return i4("nprofile",ot({0:[e8(e.pubkey)],1:(e.relays||[]).map(e=>rY.encode(e))}))}function i7(e){var t;let r,n;return void 0!==e.kind&&(t=e.kind,(n=new Uint8Array(4))[0]=t>>24&255,n[1]=t>>16&255,n[2]=t>>8&255,n[3]=255&t,r=n),i4("nevent",ot({0:[e8(e.id)],1:(e.relays||[]).map(e=>rY.encode(e)),2:e.author?[e8(e.author)]:[],3:r?[new Uint8Array(r)]:[]}))}function oe(e){let t=new ArrayBuffer(4);return new DataView(t).setUint32(0,e.kind,!1),i4("naddr",ot({0:[rY.encode(e.identifier)],1:(e.relays||[]).map(e=>rY.encode(e)),2:[e8(e.pubkey)],3:[new Uint8Array(t)]}))}function ot(e){let t=[];return Object.entries(e).reverse().forEach(([e,r])=>{r.forEach(r=>{let n=new Uint8Array(r.length+2);n.set([parseInt(e)],0),n.set([r.length],1),n.set(r,2),t.push(n)})}),e4(...t)}var or={};function on(e,t,r){let n=e instanceof Uint8Array?e3(e):e,i=oo(eq.getSharedSecret(n,"02"+t)),o=Uint8Array.from(e7(16)),s=rY.encode(r),a=rw(i,o).encrypt(s),l=tB.encode(new Uint8Array(a)),u=tB.encode(new Uint8Array(o.buffer));return`${l}?iv=${u}`}function oi(e,t,r){let n=e instanceof Uint8Array?e3(e):e,[i,o]=r.split("?iv="),s=oo(eq.getSharedSecret(n,"02"+t)),a=tB.decode(o),l=tB.decode(i),u=rw(s,a).decrypt(l);return rX.decode(u)}function oo(e){return e.slice(1,33)}rK(or,{decrypt:()=>oi,encrypt:()=>on}),rK({},{NIP05_REGEX:()=>os,isNip05:()=>oa,isValid:()=>oh,queryProfile:()=>oc,searchDomain:()=>ou,useFetchImplementation:()=>ol});var os=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,oa=e=>os.test(e||"");try{h=fetch}catch(e){}function ol(e){h=e}async function ou(e,t=""){try{let r=`https://${e}/.well-known/nostr.json?name=${t}`,n=await h(r,{redirect:"manual"});if(200!==n.status)throw Error("Wrong response code");return(await n.json()).names}catch(e){return{}}}async function oc(e){let t=e.match(os);if(!t)return null;let[,r="_",n]=t;try{let e=`https://${n}/.well-known/nostr.json?name=${r}`,t=await h(e,{redirect:"manual"});if(200!==t.status)throw Error("Wrong response code");let i=await t.json(),o=i.names[r];return o?{pubkey:o,relays:i.relays?.[o]}:null}catch(e){return null}}async function oh(e,t){let r=await oc(t);return!!r&&r.pubkey===e}function of(e){let t,r,n={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};for(let i=e.tags.length-1;i>=0;i--){let o=e.tags[i];if("e"===o[0]&&o[1]){let[e,i,s,a,l]=o,u={id:i,relays:s?[s]:[],author:l};if("root"===a){n.root=u;continue}if("reply"===a){n.reply=u;continue}if("mention"===a){n.mentions.push(u);continue}t?r=u:t=u,n.mentions.push(u);continue}if("q"===o[0]&&o[1]){let[e,t,r]=o;n.quotes.push({id:t,relays:r?[r]:[]})}if("p"===o[0]&&o[1]){n.profiles.push({pubkey:o[1],relays:o[2]?[o[2]]:[]});continue}}return n.root||(n.root=r||t||n.reply),n.reply||(n.reply=t||n.root),[n.reply,n.root].forEach(e=>{if(!e)return;let t=n.mentions.indexOf(e);if(-1!==t&&n.mentions.splice(t,1),e.author){let t=n.profiles.find(t=>t.pubkey===e.author);t&&t.relays&&(e.relays||(e.relays=[]),t.relays.forEach(t=>{e.relays?.indexOf(t)===-1&&e.relays.push(t)}),t.relays=e.relays)}}),n.mentions.forEach(e=>{if(e.author){let t=n.profiles.find(t=>t.pubkey===e.author);t&&t.relays&&(e.relays||(e.relays=[]),t.relays.forEach(t=>{-1===e.relays.indexOf(t)&&e.relays.push(t)}),t.relays=e.relays)}}),n}rK({},{parse:()=>of}),rK({},{fetchRelayInformation:()=>op,useFetchImplementation:()=>od});try{fetch}catch{}function od(e){}async function op(e){return await (await fetch(e.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}function og(e){let t=0;for(let r=0;r<64;r+=8){let n=parseInt(e.substring(r,r+8),16);if(0===n)t+=32;else{t+=Math.clz32(n);break}}return t}function oy(e,t){let r=0,n=["nonce","0",t.toString()];for(e.tags.push(n);;){let i=Math.floor(new Date().getTime()/1e3);if(i!==e.created_at&&(r=0,e.created_at=i),n[1]=(++r).toString(),e.id=ob(e),og(e.id)>=t)break}return e}function ob(e){return e3(td(rY.encode(JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content]))))}function om(e,t){var r;let n=eq.getSharedSecret(e,"02"+t).subarray(1,33);return r="nip44-v2",tr(td),void 0===r&&(r=new Uint8Array(td.outputLen)),rD(td,e6(r),e6(n))}function ow(e,t){let r=function(e,t,r,n=32){if(tr(e),te(n),n>255*e.outputLen)throw Error("Length should be <= 255*HashLen");let i=Math.ceil(n/e.outputLen);void 0===r&&(r=rW);let o=new Uint8Array(i*e.outputLen),s=rD.create(e,t),a=s._cloneInto(),l=new Uint8Array(s.outputLen);for(let t=0;t<i;t++)rF[0]=t+1,a.update(0===t?rW:l).update(r).update(rF).digestInto(l),o.set(l,e.outputLen*t),s._cloneInto(a);return s.destroy(),a.destroy(),l.fill(0),rF.fill(0),o.slice(0,n)}(td,e,t,76);return{chacha_key:r.subarray(0,32),chacha_nonce:r.subarray(32,44),hmac_key:r.subarray(44,76)}}function oE(e){if(!Number.isSafeInteger(e)||e<1)throw Error("expected positive integer");if(e<=32)return 32;let t=1<<Math.floor(Math.log2(e-1))+1,r=t<=256?32:t/8;return r*(Math.floor((e-1)/r)+1)}function ox(e,t,r){if(32!==r.length)throw Error("AAD associated data must be 32 bytes");return rD(td,e,e4(r,t))}function ov(e,t,r=e7(32)){let n,i,{chacha_key:o,chacha_nonce:s,hmac_key:a}=ow(t,r),l=rP(o,s,e4(function(e){if(!Number.isSafeInteger(e)||e<1||e>65535)throw Error("invalid plaintext size: must be between 1 and 65535 bytes");let t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}(i=(n=rY.encode(e)).length),n,new Uint8Array(oE(i)-i))),u=ox(a,l,r);return tB.encode(e4(new Uint8Array([2]),r,l,u))}function oA(e,t){let{nonce:r,ciphertext:n,mac:i}=function(e){let t;if("string"!=typeof e)throw Error("payload must be a valid string");let r=e.length;if(r<132||r>87472)throw Error("invalid payload length: "+r);if("#"===e[0])throw Error("unknown encryption version");try{t=tB.decode(e)}catch(e){throw Error("invalid base64: "+e.message)}let n=t.length;if(n<99||n>65603)throw Error("invalid data length: "+n);let i=t[0];if(2!==i)throw Error("unknown encryption version "+i);return{nonce:t.subarray(1,33),ciphertext:t.subarray(33,-32),mac:t.subarray(-32)}}(e),{chacha_key:o,chacha_nonce:s,hmac_key:a}=ow(t,r);if(!tK(ox(a,n,r),i))throw Error("invalid MAC");var l=rP(o,s,n);let u=new DataView(l.buffer).getUint16(0),c=l.subarray(2,2+u);if(u<1||u>65535||c.length!==u||l.length!==2+oE(u))throw Error("invalid padding");return rX.decode(c)}rK({},{fastEventHash:()=>ob,getPow:()=>og,minePow:()=>oy}),rK({},{unwrapEvent:()=>oC,unwrapManyEvents:()=>oq,wrapEvent:()=>oP,wrapManyEvents:()=>oH}),rK({},{createRumor:()=>oN,createSeal:()=>oT,createWrap:()=>oL,unwrapEvent:()=>oR,unwrapManyEvents:()=>o$,wrapEvent:()=>o_,wrapManyEvents:()=>oO}),rK({},{decrypt:()=>oA,encrypt:()=>ov,getConversationKey:()=>om,v2:()=>oS});var oS={utils:{getConversationKey:om,calcPaddedLen:oE},encrypt:ov,decrypt:oA},oU=()=>Math.round(Date.now()/1e3),oB=()=>Math.round(oU()-172800*Math.random()),oI=(e,t,r)=>ov(JSON.stringify(e),om(t,r)),ok=(e,t)=>JSON.parse(oA(e.content,om(t,e.pubkey)));function oN(e,t){let r={created_at:oU(),content:"",tags:[],...e,pubkey:r9(t)};return r.id=r6(r),r}function oT(e,t,r){return r7({kind:nm,content:oI(e,t,r),created_at:oB(),tags:[]},t)}function oL(e,t){let r=r5();return r7({kind:nL,content:oI(e,r,t),created_at:oB(),tags:[["p",t]]},r)}function o_(e,t,r){return oL(oT(oN(e,t),t,r),r)}function oO(e,t,r){if(!r||0===r.length)throw Error("At least one recipient is required.");let n=r9(t),i=[o_(e,t,n)];return r.forEach(r=>{i.push(o_(e,t,r))}),i}function oR(e,t){let r=ok(e,t);return ok(r,t)}function o$(e,t){let r=[];return e.forEach(e=>{r.push(oR(e,t))}),r.sort((e,t)=>e.created_at-t.created_at),r}function oP(e,t,r,n,i){let o;return o_((o={created_at:Math.ceil(Date.now()/1e3),kind:nw,tags:[],content:r},(Array.isArray(t)?t:[t]).forEach(({publicKey:e,relayUrl:t})=>{o.tags.push(t?["p",e,t]:["p",e])}),i&&o.tags.push(["e",i.eventId,i.relayUrl||"","reply"]),n&&o.tags.push(["subject",n]),o),e,t.publicKey)}function oH(e,t,r,n,i){if(!t||0===t.length)throw Error("At least one recipient is required.");return[{publicKey:r9(e)},...t].map(t=>oP(e,t,r,n,i))}var oC=oR,oq=o$;function oM(e,t,r,n){let i,o=[...e.tags??[],["e",t.id,r],["p",t.pubkey]];return t.kind===nl?i=nd:(i=nx,o.push(["k",String(t.kind)])),r7({kind:i,tags:o,content:""===e.content||t.tags?.find(e=>"-"===e[0])?"":JSON.stringify(t),created_at:e.created_at},n)}function oj(e){let t,r;if([nd,nx].includes(e.kind)){for(let n=e.tags.length-1;n>=0&&(void 0===t||void 0===r);n--){let i=e.tags[n];i.length>=2&&("e"===i[0]&&void 0===t?t=i:"p"===i[0]&&void 0===r&&(r=i))}if(void 0!==t)return{id:t[1],relays:[t[2],r?.[2]].filter(e=>"string"==typeof e),author:r?.[1]}}}function oV(e,{skipVerification:t}={}){let r,n=oj(e);if(void 0!==n&&""!==e.content){try{r=JSON.parse(e.content)}catch(e){return}if(r.id===n.id&&(t||ne(r)))return r}}rK({},{finishRepostEvent:()=>oM,getRepostedEvent:()=>oV,getRepostedEventPointer:()=>oj}),rK({},{NOSTR_URI_REGEX:()=>oz,parse:()=>oF,test:()=>oD});var oz=RegExp(`nostr:(${iQ.source})`);function oD(e){return"string"==typeof e&&RegExp(`^${oz.source}$`).test(e)}function oF(e){let t=e.match(RegExp(`^${oz.source}$`));if(!t)throw Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:i1(t[1])}}function oW(e,t,r){let n=t.tags.filter(e=>e.length>=2&&("e"===e[0]||"p"===e[0]));return r7({...e,kind:np,tags:[...e.tags??[],...n,["e",t.id],["p",t.pubkey]],content:e.content??"+"},r)}function oZ(e){let t,r;if(e.kind===np){for(let n=e.tags.length-1;n>=0&&(void 0===t||void 0===r);n--){let i=e.tags[n];i.length>=2&&("e"===i[0]&&void 0===t?t=i:"p"===i[0]&&void 0===r&&(r=i))}if(void 0!==t&&void 0!==r)return{id:t[1],relays:[t[2],r[2]].filter(e=>void 0!==e),author:r[1]}}}rK({},{finishReactionEvent:()=>oW,getReactedEventPointer:()=>oZ}),rK({},{parse:()=>oJ});var oK=/\W/m,oG=/\W |\W$|$|,| /m;function*oJ(e){let t=[];if("string"!=typeof e){for(let r=0;r<e.tags.length;r++){let n=e.tags[r];"emoji"===n[0]&&n.length>=3&&t.push({type:"emoji",shortcode:n[1],url:n[2]})}e=e.content}let r=e.length,n=0,i=0;e:for(;i<r;){let o=e.indexOf(":",i),s=e.indexOf("#",i);if(-1===o&&-1===s)break;if(-1===o||s>=0&&s<o){if(0===s||" "===e[s-1]){let t=e.slice(s+1,s+42).match(oK),o=t?s+1+t.index:r;yield{type:"text",text:e.slice(n,s)},yield{type:"hashtag",value:e.slice(s+1,o)},n=i=o;continue}i=s+1;continue}if("nostr"===e.slice(o-5,o)){let t=e.slice(o+60).match(oK),s=t?o+60+t.index:r;try{let t,{data:r,type:a}=i1(e.slice(o+1,s));switch(a){case"npub":t={pubkey:r};break;case"nsec":case"note":i=s+1;continue;default:t=r}n!==o-5&&(yield{type:"text",text:e.slice(n,o-5)}),yield{type:"reference",pointer:t},n=i=s;continue}catch(e){i=o+1;continue}}if("https"===e.slice(o-5,o)||"http"===e.slice(o-4,o)){let t=e.slice(o+4).match(oG),s=t?o+4+t.index:r,a="s"===e[o-1]?5:4;try{let t=new URL(e.slice(o-a,s));if(-1===t.hostname.indexOf("."))throw Error("invalid url");if(n!==o-a&&(yield{type:"text",text:e.slice(n,o-a)}),/\.(png|jpe?g|gif|webp|heic|svg)$/i.test(t.pathname)){yield{type:"image",url:t.toString()},n=i=s;continue}if(/\.(mp4|avi|webm|mkv|mov)$/i.test(t.pathname)){yield{type:"video",url:t.toString()},n=i=s;continue}if(/\.(mp3|aac|ogg|opus|wav|flac)$/i.test(t.pathname)){yield{type:"audio",url:t.toString()},n=i=s;continue}yield{type:"url",url:t.toString()},n=i=s;continue}catch(e){i=s+1;continue}}if("wss"===e.slice(o-3,o)||"ws"===e.slice(o-2,o)){let t=e.slice(o+4).match(oG),s=t?o+4+t.index:r,a="s"===e[o-1]?3:2;try{let t=new URL(e.slice(o-a,s));if(-1===t.hostname.indexOf("."))throw Error("invalid ws url");n!==o-a&&(yield{type:"text",text:e.slice(n,o-a)}),yield{type:"relay",url:t.toString()},n=i=s;continue}catch(e){i=s+1;continue}}else{for(let r=0;r<t.length;r++){let s=t[r];if(":"===e[o+s.shortcode.length+1]&&e.slice(o+1,o+s.shortcode.length+1)===s.shortcode){n!==o&&(yield{type:"text",text:e.slice(n,o)}),yield s,n=i=o+s.shortcode.length+2;continue e}}i=o+1;continue}}n!==r&&(yield{type:"text",text:e.slice(n)})}rK({},{channelCreateEvent:()=>oX,channelHideMessageEvent:()=>o0,channelMessageEvent:()=>oQ,channelMetadataEvent:()=>oY,channelMuteUserEvent:()=>o1});var oX=(e,t)=>{let r;if("object"==typeof e.content)r=JSON.stringify(e.content);else{if("string"!=typeof e.content)return;r=e.content}return r7({kind:nU,tags:[...e.tags??[]],content:r,created_at:e.created_at},t)},oY=(e,t)=>{let r;if("object"==typeof e.content)r=JSON.stringify(e.content);else{if("string"!=typeof e.content)return;r=e.content}return r7({kind:nB,tags:[["e",e.channel_create_event_id],...e.tags??[]],content:r,created_at:e.created_at},t)},oQ=(e,t)=>{let r=[["e",e.channel_create_event_id,e.relay_url,"root"]];return e.reply_to_channel_message_event_id&&r.push(["e",e.reply_to_channel_message_event_id,e.relay_url,"reply"]),r7({kind:nI,tags:[...r,...e.tags??[]],content:e.content,created_at:e.created_at},t)},o0=(e,t)=>{let r;if("object"==typeof e.content)r=JSON.stringify(e.content);else{if("string"!=typeof e.content)return;r=e.content}return r7({kind:nk,tags:[["e",e.channel_message_event_id],...e.tags??[]],content:r,created_at:e.created_at},t)},o1=(e,t)=>{let r;if("object"==typeof e.content)r=JSON.stringify(e.content);else{if("string"!=typeof e.content)return;r=e.content}return r7({kind:nN,tags:[["p",e.pubkey_to_mute],...e.tags??[]],content:r,created_at:e.created_at},t)};rK({},{EMOJI_SHORTCODE_REGEX:()=>o2,matchAll:()=>o8,regex:()=>o3,replaceAll:()=>o6});var o2=/:(\w+):/,o3=()=>RegExp(`\\B${o2.source}\\B`,"g");function*o8(e){for(let t of e.matchAll(o3()))try{let[e,r]=t;yield{shortcode:e,name:r,start:t.index,end:t.index+e.length}}catch(e){}}function o6(e,t){return e.replaceAll(o3(),(e,r)=>t({shortcode:e,name:r}))}rK({},{useFetchImplementation:()=>o4,validateGithub:()=>o5});try{f=fetch}catch{}function o4(e){f=e}async function o5(e,t,r){try{return await (await f(`https://gist.github.com/${t}/${r}/raw`)).text()===`Verifying that I control the following Nostr public key: ${e}`}catch(e){return!1}}function o9(e){let{host:t,pathname:r,searchParams:n}=new URL(e),i=r||t,o=n.get("relay"),s=n.get("secret");if(!i||!o||!s)throw Error("invalid connection string");return{pubkey:i,relay:o,secret:s}}async function o7(e,t,r){let n=on(t,e,JSON.stringify({method:"pay_invoice",params:{invoice:r}}));return r7({kind:io,created_at:Math.round(Date.now()/1e3),content:n,tags:[["p",e]]},t)}function se(e){return Array.from(e=(e=e.trim().toLowerCase()).normalize("NFKC")).map(e=>/\p{Letter}/u.test(e)||/\p{Number}/u.test(e)?e:"-").join("")}rK({},{makeNwcRequestEvent:()=>o7,parseConnectionString:()=>o9}),rK({},{normalizeIdentifier:()=>se}),rK({},{getSatoshisAmountFromBolt11:()=>ss,getZapEndpoint:()=>sr,makeZapReceipt:()=>so,makeZapRequest:()=>sn,useFetchImplementation:()=>st,validateZapRequest:()=>si});try{d=fetch}catch{}function st(e){d=e}async function sr(e){try{let t="",{lud06:r,lud16:n}=JSON.parse(e.content);if(n){let[e,r]=n.split("@");t=new URL(`/.well-known/lnurlp/${e}`,`https://${r}`).toString()}else{if(!r)return null;let{words:e}=tO.decode(r,1e3),n=tO.fromWords(e);t=rX.decode(n)}let i=await d(t),o=await i.json();if(o.allowsNostr&&o.nostrPubkey)return o.callback}catch(e){}return null}function sn(e){let t={kind:9734,created_at:Math.round(Date.now()/1e3),content:e.comment||"",tags:[["p","pubkey"in e?e.pubkey:e.event.pubkey],["amount",e.amount.toString()],["relays",...e.relays]]};if("event"in e){if(t.tags.push(["e",e.event.id]),nr(e.event.kind)){let r=["a",`${e.event.kind}:${e.event.pubkey}:`];t.tags.push(r)}else if(ni(e.event.kind)){let r=e.event.tags.find(([e,t])=>"d"===e&&t);if(!r)throw Error("d tag not found or is empty");let n=["a",`${e.event.kind}:${e.event.pubkey}:${r[1]}`];t.tags.push(n)}t.tags.push(["k",e.event.kind.toString()])}return t}function si(e){let t;try{t=JSON.parse(e)}catch(e){return"Invalid zap request JSON."}if(!rJ(t))return"Zap request is not a valid Nostr event.";if(!ne(t))return"Invalid signature on zap request.";let r=t.tags.find(([e,t])=>"p"===e&&t);if(!r)return"Zap request doesn't have a 'p' tag.";if(!r[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let n=t.tags.find(([e,t])=>"e"===e&&t);return n&&!n[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find(([e,t])=>"relays"===e&&t)?null:"Zap request doesn't have a 'relays' tag."}function so({zapRequest:e,preimage:t,bolt11:r,paidAt:n}){let i=JSON.parse(e),o=i.tags.filter(([e])=>"e"===e||"p"===e||"a"===e),s={kind:9735,created_at:Math.round(n.getTime()/1e3),content:"",tags:[...o,["P",i.pubkey],["bolt11",r],["description",e]]};return t&&s.tags.push(["preimage",t]),s}function ss(e){if(e.length<50)return 0;let t=(e=e.substring(0,50)).lastIndexOf("1");if(-1===t)return 0;let r=e.substring(0,t);if(!r.startsWith("lnbc"))return 0;let n=r.substring(4);if(n.length<1)return 0;let i=n[n.length-1],o=i.charCodeAt(0)-48,s=n.length-1;if(o>=0&&o<=9&&s++,s<1)return 0;let a=parseInt(n.substring(0,s));switch(i){case"m":return 1e5*a;case"u":return 100*a;case"n":return a/10;case"p":return a/1e4;default:return 1e8*a}}rK({},{Negentropy:()=>sd,NegentropyStorageVector:()=>sf,NegentropySync:()=>sy});var sa=class{_raw;length;constructor(e){"number"==typeof e?(this._raw=new Uint8Array(e),this.length=0):e instanceof Uint8Array?(this._raw=new Uint8Array(e),this.length=e.length):(this._raw=new Uint8Array(512),this.length=0)}unwrap(){return this._raw.subarray(0,this.length)}get capacity(){return this._raw.byteLength}extend(e){if(e instanceof sa&&(e=e.unwrap()),"number"!=typeof e.length)throw Error("bad length");let t=e.length+this.length;if(this.capacity<t){let e=this._raw,r=Math.max(2*this.capacity,t);this._raw=new Uint8Array(r),this._raw.set(e)}this._raw.set(e,this.length),this.length+=e.length}shift(){let e=this._raw[0];return this._raw=this._raw.subarray(1),this.length--,e}shiftN(e=1){let t=this._raw.subarray(0,e);return this._raw=this._raw.subarray(e),this.length-=e,t}};function sl(e){let t=0;for(;;){if(0===e.length)throw Error("parse ends prematurely");let r=e.shift();if(t=t<<7|127&r,(128&r)==0)break}return t}function su(e){if(0===e)return new sa(new Uint8Array([0]));let t=[];for(;0!==e;)t.push(127&e),e>>>=7;t.reverse();for(let e=0;e<t.length-1;e++)t[e]|=128;return new sa(new Uint8Array(t))}function sc(e,t){if(e.length<t)throw Error("parse ends prematurely");return e.shiftN(t)}var sh=class{buf;constructor(){this.setToZero()}setToZero(){this.buf=new Uint8Array(32)}add(e){let t=0,r=0,n=new DataView(this.buf.buffer),i=new DataView(e.buffer);for(let e=0;e<8;e++){let o=4*e,s=n.getUint32(o,!0),a=i.getUint32(o,!0),l=s;l+=t,(l+=a)>0xffffffff&&(r=1),n.setUint32(o,0|l,!0),t=r,r=0}}negate(){let e=new DataView(this.buf.buffer);for(let t=0;t<8;t++){let r=4*t;e.setUint32(r,~e.getUint32(r,!0))}let t=new Uint8Array(32);t[0]=1,this.add(t)}getFingerprint(e){let t=new sa;return t.extend(this.buf),t.extend(su(e)),td(t.unwrap()).subarray(0,16)}},sf=class{items;sealed;constructor(){this.items=[],this.sealed=!1}insert(e,t){if(this.sealed)throw Error("already sealed");let r=tW(t);if(32!==r.byteLength)throw Error("bad id size for added item");this.items.push({timestamp:e,id:r})}seal(){if(this.sealed)throw Error("already sealed");this.sealed=!0,this.items.sort(sg);for(let e=1;e<this.items.length;e++)if(0===sg(this.items[e-1],this.items[e]))throw Error("duplicate item inserted")}unseal(){this.sealed=!1}size(){return this._checkSealed(),this.items.length}getItem(e){if(this._checkSealed(),e>=this.items.length)throw Error("out of range");return this.items[e]}iterate(e,t,r){this._checkSealed(),this._checkBounds(e,t);for(let n=e;n<t&&r(this.items[n],n);++n);}findLowerBound(e,t,r){return this._checkSealed(),this._checkBounds(e,t),this._binarySearch(this.items,e,t,e=>0>sg(e,r))}fingerprint(e,t){let r=new sh;return r.setToZero(),this.iterate(e,t,e=>(r.add(e.id),!0)),r.getFingerprint(t-e)}_checkSealed(){if(!this.sealed)throw Error("not sealed")}_checkBounds(e,t){if(e>t||t>this.items.length)throw Error("bad range")}_binarySearch(e,t,r,n){let i=r-t;for(;i>0;){let r=t,o=Math.floor(i/2);n(e[r+=o])?(t=++r,i-=o+1):i=o}return t}},sd=class{storage;frameSizeLimit;lastTimestampIn;lastTimestampOut;constructor(e,t=6e4){if(t<4096)throw Error("frameSizeLimit too small");this.storage=e,this.frameSizeLimit=t,this.lastTimestampIn=0,this.lastTimestampOut=0}_bound(e,t){return{timestamp:e,id:t||new Uint8Array(0)}}initiate(){let e=new sa;return e.extend(new Uint8Array([97])),this.splitRange(0,this.storage.size(),this._bound(Number.MAX_VALUE),e),tD(e.unwrap())}reconcile(e,t,r){let n=new sa(tW(e));this.lastTimestampIn=this.lastTimestampOut=0;let i=new sa;i.extend(new Uint8Array([97]));let o=sc(n,1)[0];if(o<96||o>111)throw Error("invalid negentropy protocol version byte");if(97!==o)throw Error("unsupported negentropy protocol version requested: "+(o-96));let s=this.storage.size(),a=this._bound(0),l=0,u=!1;for(;0!==n.length;){let e=new sa,o=()=>{u&&(u=!1,e.extend(this.encodeBound(a)),e.extend(su(0)))},c=this.decodeBound(n),h=sl(n),f=l,d=this.storage.findLowerBound(l,s,c);if(0===h)u=!0;else if(1===h)0!==sp(sc(n,16),this.storage.fingerprint(f,d))?(o(),this.splitRange(f,d,c,e)):u=!0;else if(2===h){let e=sl(n),i={};for(let t=0;t<e;t++){let e=sc(n,32);i[tD(e)]=e}if(u=!0,this.storage.iterate(f,d,e=>{let r=e.id,n=tD(r);return i[n]?delete i[tD(r)]:t?.(n),!0}),r)for(let e of Object.values(i))r(tD(e))}else throw Error("unexpected mode");if(this.exceededFrameSizeLimit(i.length+e.length)){let e=this.storage.fingerprint(d,s);i.extend(this.encodeBound(this._bound(Number.MAX_VALUE))),i.extend(su(1)),i.extend(e);break}i.extend(e),l=d,a=c}return 1===i.length?null:tD(i.unwrap())}splitRange(e,t,r,n){let i=t-e;if(i<32)n.extend(this.encodeBound(r)),n.extend(su(2)),n.extend(su(i)),this.storage.iterate(e,t,e=>(n.extend(e.id),!0));else{let o=Math.floor(i/16),s=i%16,a=e;for(let e=0;e<16;e++){let i,l=o+ +(e<s),u=this.storage.fingerprint(a,a+l);if((a+=l)===t)i=r;else{let e,t;this.storage.iterate(a-1,a+1,(r,n)=>(n===a-1?e=r:t=r,!0)),i=this.getMinimalBound(e,t)}n.extend(this.encodeBound(i)),n.extend(su(1)),n.extend(u)}}}exceededFrameSizeLimit(e){return e>this.frameSizeLimit-200}decodeTimestampIn(e){let t=sl(e);return(t=0===t?Number.MAX_VALUE:t-1,this.lastTimestampIn===Number.MAX_VALUE||t===Number.MAX_VALUE)?(this.lastTimestampIn=Number.MAX_VALUE,Number.MAX_VALUE):(t+=this.lastTimestampIn,this.lastTimestampIn=t,t)}decodeBound(e){let t=this.decodeTimestampIn(e),r=sl(e);if(r>32)throw Error("bound key too long");return{timestamp:t,id:sc(e,r)}}encodeTimestampOut(e){if(e===Number.MAX_VALUE)return this.lastTimestampOut=Number.MAX_VALUE,su(0);let t=e;return e-=this.lastTimestampOut,this.lastTimestampOut=t,su(e+1)}encodeBound(e){let t=new sa;return t.extend(this.encodeTimestampOut(e.timestamp)),t.extend(su(e.id.length)),t.extend(e.id),t}getMinimalBound(e,t){if(t.timestamp!==e.timestamp)return this._bound(t.timestamp);{let r=0,n=t.id,i=e.id;for(let e=0;e<32&&n[e]===i[e];e++)r++;return this._bound(t.timestamp,t.id.subarray(0,r+1))}}};function sp(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return -1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function sg(e,t){return e.timestamp===t.timestamp?sp(e.id,t.id):e.timestamp-t.timestamp}var sy=class{relay;storage;neg;filter;subscription;onhave;onneed;constructor(e,t,r,n={}){this.relay=e,this.storage=t,this.neg=new sd(t),this.onhave=n.onhave,this.onneed=n.onneed,this.filter=r,this.subscription=this.relay.prepareSubscription([{}],{label:n.label||"negentropy"}),this.subscription.oncustom=e=>{switch(e[0]){case"NEG-MSG":e.length<3&&console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${e}`);try{let t=this.neg.reconcile(e[2],this.onhave,this.onneed);t?this.relay.send(`["NEG-MSG", "${this.subscription.id}", "${t}"]`):(this.close(),n.onclose?.())}catch(e){console.error("negentropy reconcile error:",e),n?.onclose?.(`reconcile error: ${e}`)}break;case"NEG-CLOSE":{let t=e[2];console.warn("negentropy error:",t),n.onclose?.(t);break}case"NEG-ERR":n.onclose?.()}}}async start(){let e=this.neg.initiate();this.relay.send(`["NEG-OPEN","${this.subscription.id}",${JSON.stringify(this.filter)},"${e}"]`)}close(){this.relay.send(`["NEG-CLOSE","${this.subscription.id}"]`),this.subscription.close()}};rK({},{getToken:()=>sm,hashPayload:()=>sU,unpackEventFromToken:()=>sE,validateEvent:()=>sI,validateEventKind:()=>sv,validateEventMethodTag:()=>sS,validateEventPayloadTag:()=>sB,validateEventTimestamp:()=>sx,validateEventUrlTag:()=>sA,validateToken:()=>sw});var sb="Nostr ";async function sm(e,t,r,n=!1,i){let o={kind:il,tags:[["u",e],["method",t]],created_at:Math.round(new Date().getTime()/1e3),content:""};i&&o.tags.push(["payload",sU(i)]);let s=await r(o);return(n?sb:"")+tB.encode(rY.encode(JSON.stringify(s)))}async function sw(e,t,r){let n=await sE(e).catch(e=>{throw e});return await sI(n,t,r).catch(e=>{throw e})}async function sE(e){if(!e)throw Error("Missing token");e=e.replace(sb,"");let t=rX.decode(tB.decode(e));if(!t||0===t.length||!t.startsWith("{"))throw Error("Invalid token");return JSON.parse(t)}function sx(e){return!!e.created_at&&Math.round(new Date().getTime()/1e3)-e.created_at<60}function sv(e){return e.kind===il}function sA(e,t){let r=e.tags.find(e=>"u"===e[0]);return!!r&&r.length>0&&r[1]===t}function sS(e,t){let r=e.tags.find(e=>"method"===e[0]);return!!r&&r.length>0&&r[1].toLowerCase()===t.toLowerCase()}function sU(e){return e3(td(rY.encode(JSON.stringify(e))))}function sB(e,t){let r=e.tags.find(e=>"payload"===e[0]);if(!r)return!1;let n=sU(t);return r.length>0&&r[1]===n}async function sI(e,t,r,n){if(!ne(e))throw Error("Invalid nostr event, signature invalid");if(!sv(e))throw Error("Invalid nostr event, kind invalid");if(!sx(e))throw Error("Invalid nostr event, created_at timestamp invalid");if(!sA(e,t))throw Error("Invalid nostr event, url tag invalid");if(!sS(e,r))throw Error("Invalid nostr event, method tag invalid");if(n&&"object"==typeof n&&Object.keys(n).length>0&&!sB(e,n))throw Error("Invalid nostr event, payload tag does not match request body hash");return!0}var sk=e.i(2124);let sN=["wss://relay.primal.net","wss://relay.damus.io"],sT="a4a9df1630ef1b2f22b3c5ba56a14773c2b99f7a9eafaca30d7d6f90767acd9f";e.s(["default",0,()=>{let e=(0,g.useRef)(new iJ),[t,r]=(0,g.useState)(""),[n,i]=(0,g.useState)(""),[o,s]=(0,g.useState)(""),[a,l]=(0,g.useState)(""),[u,c]=(0,g.useState)(null),[h,f]=(0,g.useState)(null),[d,y]=(0,g.useState)(!1),[b,m]=(0,g.useState)(null),[w,E]=(0,g.useState)(null);(0,g.useEffect)(()=>{let t=e.current;return()=>{t.close(sN)}},[]),(0,g.useEffect)(()=>{let e=r5(),t=r9(e);m(e),E(t)},[]);let x=async()=>{if(c(null),f(null),!b||!w)return void f("Generating keypair, please wait a moment and retry.");if(!n.trim()||!o.trim()||!t.trim()||!a.trim())return void f("All fields are required.");y(!0);try{let u=`Name: ${n.trim()}
Subject: ${o.trim()}
Contact: ${a.trim()}

${t.trim()}`,h=await or.encrypt(b,sT,u),f={kind:4,created_at:Math.floor(Date.now()/1e3),tags:[["p",sT]],content:h},d=r7(f,b),p=e.current.publish(sN,d);await Promise.all(p),c("Message sent! You can close this tab or send another."),r(""),i(""),s(""),l("")}catch(e){console.error(e),f(e instanceof Error?e.message:"Failed to send message.")}finally{y(!1)}};return(0,p.jsxs)(sk.default,{children:[(0,p.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Send me a message"}),(0,p.jsx)("p",{className:"mb-6 text-slate-700",children:"If you find my resume interesting, send me a private message. Leave your email and I will reply back to you."}),(0,p.jsx)("div",{className:"card bg-white shadow-md border border-slate-200",children:(0,p.jsxs)("div",{className:"card-body space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:(0,p.jsx)("span",{className:"label-text font-semibold",children:"Subject"})}),(0,p.jsx)("input",{className:"input input-bordered w-full",value:o,onChange:e=>s(e.target.value),placeholder:"Subject"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:(0,p.jsx)("span",{className:"label-text font-semibold",children:"Message"})}),(0,p.jsx)("textarea",{className:"textarea textarea-bordered w-full h-32",value:t,onChange:e=>r(e.target.value),placeholder:"Introduce yourself and include any contact details you'd like me to use."})]}),(0,p.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:(0,p.jsx)("span",{className:"label-text font-semibold",children:"Full name"})}),(0,p.jsx)("input",{className:"input input-bordered w-full",value:n,onChange:e=>i(e.target.value),placeholder:"Your name"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:(0,p.jsx)("span",{className:"label-text font-semibold",children:"Contact (email or phone)"})}),(0,p.jsx)("input",{className:"input input-bordered w-full",value:a,onChange:e=>l(e.target.value),placeholder:"Email or phone"})]})]}),(0,p.jsx)("button",{className:"btn btn-primary text-white",onClick:x,disabled:d||!sT,children:d?"Sending":"Send via Nostr"}),u&&(0,p.jsx)("div",{className:"text-sm text-success",children:u}),h&&(0,p.jsx)("div",{className:"text-sm text-error",children:h})]})})]})}],8948)},6914,(e,t,r)=>{let n="/contact";(window.__NEXT_P=window.__NEXT_P||[]).push([n,()=>e.r(8948)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([n])})}]);